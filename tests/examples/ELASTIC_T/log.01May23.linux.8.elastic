LAMMPS (28 Mar 2023 - Development)
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 2.0e-2

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
variable nequil equal 10*${nthermo}       # length of equilibration run
variable nequil equal 10*100       
variable nrun equal 3*${nthermo}          # length of equilibrated run
variable nrun equal 3*100          
variable temp equal 2000.0                # temperature of initial sample
variable timestep equal 0.001             # timestep
variable mass1 equal 28.06                # mass
variable adiabatic equal 0                # adiabatic (1) or isothermal (2)
variable tdamp equal 0.01                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat

# generate the box and atom positions using a diamond lattice
variable a equal 5.431

boundary	p p p

lattice         diamond $a
lattice         diamond 5.431
Lattice spacing in x,y,z = 5.431 5.431 5.431
region		box prism 0 3.0 0 3.0 0 3.0 0.0 0.0 0.0
create_box	1 box
Created triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
create_atoms	1 box
Created 216 atoms
  using lattice units in triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  create_atoms CPU = 0.001 seconds
mass 1 ${mass1}
mass 1 28.06
velocity	all create ${temp} 87287
velocity	all create 2000 87287



# Compute initial state

variable thermostat equal 1
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2000          -936.7056       13698.023      0              0              0              0              0              0            
       100   1909.5283     -881.86568      19900.507      22833.678      22262.119      21127.195     -455.14745     -2616.9461     -7086.0456    
       200   1967.9887     -875.72605      17314.712      19553.532      19390.308      19917.91      -749.1094       160.41684     -854.25622    
       300   1869.2682     -872.78258      15456.142      18265.191      16276.352      17942.286      1624.4077     -2635.9288     -4183.6593    
       400   2239.0196     -872.49451      17752.218      15728.928      17528.796      15558.304     -1334.8351     -604.70427     -289.64846    
       500   2265.718      -873.21063      22332.355      18189.959      17991.141      18071.292     -3380.5486     -3044.3617     -2897.4361    
       600   1886.6116     -873.60169      16142.009      18451.861      15201.26       15316.459      3852.4867      1239.1903     -975.51927    
       700   2243.6891     -872.67346      18347.221      16815.456      16721.432      19043.432      3860.214       751.16345     -2969.0423    
       800   1800.3738     -875.87202      17232.391      18337.127      17688.849      16923.578      225.27706      3498.6273      3691.5581    
       900   2011.3785     -879.75397      15683.038      16452.257      17100.515      16779.69       3283.2593     -383.07377     -1649.6035    
      1000   1932.9542     -869.42063      19037.213      18149.262      19431.642      17848.162      4501.0443     -2580.1085      4451.8611    
Loop time of 0.212943 on 8 procs for 1000 steps with 216 atoms

Performance: 405.742 ns/day, 0.059 hours/ns, 4696.090 timesteps/s, 1.014 Matom-step/s
99.4% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.093022   | 0.11811    | 0.15443    |   5.5 | 55.46
Neigh   | 0.0014069  | 0.001886   | 0.002416   |   0.8 |  0.89
Comm    | 0.046685   | 0.083334   | 0.10879    |   6.6 | 39.13
Output  | 0.00034068 | 0.00037419 | 0.00050073 |   0.0 |  0.18
Modify  | 0.0032579  | 0.0036366  | 0.0040213  |   0.5 |  1.71
Other   |            | 0.005607   |            |       |  2.63

Nlocal:             27 ave          29 max          25 min
Histogram: 1 0 3 0 0 0 0 3 0 1
Nghost:          252.5 ave         255 max         250 min
Histogram: 1 0 1 0 2 0 2 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        702.5 ave         749 max         644 min
Histogram: 1 0 0 2 1 0 0 1 2 1

Total # of neighbors = 5620
Ave neighs/atom = 26.018519
Neighbor list builds = 31
Dangerous builds = 0

if "${adiabatic} == 1" then "variable thermostat equal 0" else "variable thermostat equal 1"
variable thermostat equal 1

print ${thermostat}
print 1
1

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   1932.9542     -869.42063      19037.213      0              0              0              0              0              0            
       100   1812.0352     -877.71571      16839.248      18400.082      16822.832      18864.97      -1390.7549     -1344.7363     -208.75588    
       200   2001.5959     -881.28676      16587.72       17615.69       16411.367      19967.198     -4241.8346     -457.11829     -4858.249     
       300   2155.8855     -876.218        16272.55       16455.044      16380.108      18213.412      1207.1306     -2841.3846     -278.21666    
Loop time of 0.0466587 on 8 procs for 300 steps with 216 atoms

Performance: 555.523 ns/day, 0.043 hours/ns, 6429.666 timesteps/s, 1.389 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.028196   | 0.030414   | 0.033289   |   0.9 | 65.18
Neigh   | 0.000448   | 0.00046744 | 0.00050061 |   0.0 |  1.00
Comm    | 0.010621   | 0.013543   | 0.015738   |   1.3 | 29.03
Output  | 8.9965e-05 | 9.6443e-05 | 0.00012933 |   0.0 |  0.21
Modify  | 0.0008907  | 0.00091526 | 0.00094789 |   0.0 |  1.96
Other   |            | 0.001223   |            |       |  2.62

Nlocal:             27 ave          30 max          26 min
Histogram: 4 0 2 0 0 1 0 0 0 1
Nghost:          252.5 ave         254 max         250 min
Histogram: 1 0 0 0 0 3 0 2 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        703.5 ave         795 max         675 min
Histogram: 4 2 0 0 1 0 0 0 0 1

Total # of neighbors = 5628
Ave neighs/atom = 26.055556
Neighbor list builds = 10
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.293
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 16.293
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.293

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-16455.04440855)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1-16455.04440855)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-16380.1076191558)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1-16380.1076191558)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-18213.4120843484)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1-18213.4120843484)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--278.216657568161)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--278.216657568161)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--2841.38464506173)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--2841.38464506173)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-1207.13062423142)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-1207.13062423142)/(v_delta/v_len0)*0.0001

# Write restart
write_restart restart.equil
System init for write_restart ...

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.293
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.32586 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.32586 xy delta -0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.32586 xy delta -0 xz delta -0 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.96714 16.293 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (15.96714 16.293 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (15.96714 16.293 16.293) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.48293      37741.312      0              0              0              0              0              0            
       100   2226.181      -871.24158      39136.959      46186.77       35735.282      35210.602     -7567.1274      3419.3618     -2660.6604    
       200   2018.3254     -867.63737      36045.118      43318.287      32213.228      33376.409     -2569.9557     -4248.9233     -8838.1662    
       300   2075.8665     -872.14509      37917.33       42541.962      33073.011      37423.268      2598.0104     -1584.7657     -2219.087     
       400   2019.6425     -873.66924      35102.689      38774.329      34010.334      32422.423     -1889.9244      6382.3304      756.13238    
       500   2072.7661     -872.41106      35507.704      43860.723      35744.558      33526.283      1014.7347      2707.0993     -3700.9434    
       600   1729.5298     -877.71656      35228.759      41952.116      33519.404      34515.734     -257.78994      326.05743      3231.6385    
       700   1969.158      -877.36692      34296.194      41621.622      35416.352      35143.246      947.66711     -495.46597     -2541.6351    
       800   1917.81       -876.9511       34622.229      42670.11       31808.537      32837.186      2188.3094      858.29704     -1464.7786    
       900   2101.6987     -872.49397      39690.054      44917.882      35219.236      35621.164      2999.5007      4248.2713     -371.75994    
      1000   2143.7552     -872.5148       39916.056      43661.474      35200.736      34726.343      3241.3818     -6096.1334     -1868.7559    
Loop time of 0.181311 on 8 procs for 1000 steps with 216 atoms

Performance: 476.529 ns/day, 0.050 hours/ns, 5515.383 timesteps/s, 1.191 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.10875    | 0.11751    | 0.12665    |   2.1 | 64.81
Neigh   | 0.0014308  | 0.0015349  | 0.0016321  |   0.2 |  0.85
Comm    | 0.045367   | 0.054536   | 0.063384   |   3.0 | 30.08
Output  | 0.00031228 | 0.00032788 | 0.00042425 |   0.0 |  0.18
Modify  | 0.0030354  | 0.0031292  | 0.0032277  |   0.1 |  1.73
Other   |            | 0.004269   |            |       |  2.35

Nlocal:             27 ave          32 max          22 min
Histogram: 1 1 0 1 0 1 1 1 1 1
Nghost:            253 ave         257 max         248 min
Histogram: 1 0 1 1 0 2 0 0 2 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        711.5 ave         850 max         571 min
Histogram: 1 1 0 1 0 2 0 1 1 1

Total # of neighbors = 5692
Ave neighs/atom = 26.351852
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2143.7552     -872.5148       39916.056      0              0              0              0              0              0            
       100   2185.6598     -876.73247      40334.695      44426.486      33607.255      33700.287     -610.23534     -1820.1643      1867.3926    
       200   2117.3157     -877.21412      35675.223      45382.019      34164.355      35775.797      1354.73       -1908.5357      744.02769    
       300   2003.775      -866.40238      35560.193      41810.741      30675.664      34605.034      2441.749      -955.69597     -3937.0525    
Loop time of 0.0537162 on 8 procs for 300 steps with 216 atoms

Performance: 482.536 ns/day, 0.050 hours/ns, 5584.908 timesteps/s, 1.206 Matom-step/s
99.3% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.031737   | 0.035197   | 0.039442   |   1.4 | 65.52
Neigh   | 0.00045416 | 0.00048765 | 0.00056184 |   0.0 |  0.91
Comm    | 0.011398   | 0.015652   | 0.01917    |   2.1 | 29.14
Output  | 9.4759e-05 | 0.00010016 | 0.00013235 |   0.0 |  0.19
Modify  | 0.00089859 | 0.00095008 | 0.0010105  |   0.0 |  1.77
Other   |            | 0.001329   |            |       |  2.47

Nlocal:             27 ave          31 max          24 min
Histogram: 1 1 2 0 2 0 0 0 1 1
Nghost:         252.25 ave         256 max         247 min
Histogram: 1 0 0 1 0 2 1 2 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          709 ave         812 max         635 min
Histogram: 1 1 2 0 2 0 0 0 1 1

Total # of neighbors = 5672
Ave neighs/atom = 26.259259
Neighbor list builds = 10
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 126.778481829785
variable C2neg equal ${d2}
variable C2neg equal 71.4777796121415
variable C3neg equal ${d3}
variable C3neg equal 81.9581075222585
variable C4neg equal ${d4}
variable C4neg equal -18.2941794183687
variable C5neg equal ${d5}
variable C5neg equal 9.42844339171094
variable C6neg equal ${d6}
variable C6neg equal 6.17309182214525

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.32586 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.32586 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.32586 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.61886 16.293 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (16.61886 16.293 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (16.61886 16.293 16.293) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.42227     -3544.3909      0              0              0              0              0              0            
       100   2138.9687     -872.27991     -1579.5059     -7540.9142      2464.3453      2270.9614     -7400.171       2669.0743     -2328.6511    
       200   1931.1497     -875.3685      -1159.5605     -7635.9384     -365.02626      792.94656     -1219.4405      223.35618     -1394.4734    
       300   1828.2935     -873.65574     -5203.518      -8735.9306      2715.7637      1954.1185     -3220.6983      362.9389      -2914.9623    
       400   2004.8404     -876.23376     -2922.3201     -9835.01        509.13239      1718.6004     -48.740518     -1319.8725      987.0683     
       500   2197.6659     -871.07041     -3133.6811     -9302.483      -1709.0418      1517.6445      1948.2677      2331.7382     -1112.0473    
       600   1913.6588     -881.53097     -4336.4842     -9799.6474      2100.0594      238.83037      581.30687     -3366.0509     -795.84061    
       700   2198.4673     -876.82968     -800.62942     -8110.3203      1851.5893      2904.5927     -1417.1985     -354.3787      -5755.7984    
       800   1978.7743     -872.9042       153.94675     -7420.0739      2521.5393      5173.415       5845.4814     -3111.5121     -2923.382     
       900   2113.1735     -872.93973     -904.52447     -8123.7149      4516.5988      2489.5534      2957.7551      911.68003      5778.8381    
      1000   2001.8775     -872.18969     -1919.6741     -8443.8696      999.88463      954.59269      2328.8598     -752.01247      1998.2404    
Loop time of 0.168084 on 8 procs for 1000 steps with 216 atoms

Performance: 514.030 ns/day, 0.047 hours/ns, 5949.417 timesteps/s, 1.285 Matom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.084689   | 0.096341   | 0.11677    |   3.6 | 57.32
Neigh   | 0.0015133  | 0.0016441  | 0.0020021  |   0.4 |  0.98
Comm    | 0.04109    | 0.061483   | 0.072803   |   4.5 | 36.58
Output  | 0.00034418 | 0.00036475 | 0.00046545 |   0.0 |  0.22
Modify  | 0.0031554  | 0.0032725  | 0.0035684  |   0.2 |  1.95
Other   |            | 0.004978   |            |       |  2.96

Nlocal:             27 ave          30 max          25 min
Histogram: 2 0 2 0 2 0 0 0 0 2
Nghost:            253 ave         256 max         250 min
Histogram: 2 0 0 1 0 1 2 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          699 ave         779 max         636 min
Histogram: 2 0 0 3 1 0 0 0 0 2

Total # of neighbors = 5592
Ave neighs/atom = 25.888889
Neighbor list builds = 33
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2001.8775     -872.18969     -1919.6741      0              0              0              0              0              0            
       100   2165.1206     -873.01993     -3645.4162     -6626.569       1019.6265      669.45164     -1174.3145      4132.1218      1699.9255    
       200   2105.2201     -871.30738     -1408.704      -9209.2854      2126.6878      1092.5515     -289.17521      6575.5823      834.96524    
       300   1917.3788     -876.90382     -2544.3873     -9489.3785      429.80389      885.8818      -1900.82        2625.5904     -519.65545    
Loop time of 0.0585086 on 8 procs for 300 steps with 216 atoms

Performance: 443.012 ns/day, 0.054 hours/ns, 5127.450 timesteps/s, 1.108 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.024637   | 0.031598   | 0.042689   |   3.6 | 54.01
Neigh   | 0.00045148 | 0.00055144 | 0.00077962 |   0.0 |  0.94
Comm    | 0.012081   | 0.023051   | 0.03008    |   4.1 | 39.40
Output  | 0.00010662 | 0.00011547 | 0.00014911 |   0.0 |  0.20
Modify  | 0.0010602  | 0.001137   | 0.0013304  |   0.3 |  1.94
Other   |            | 0.002056   |            |       |  3.51

Nlocal:             27 ave          29 max          25 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Nghost:            252 ave         254 max         250 min
Histogram: 2 0 0 0 0 3 0 2 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          700 ave         761 max         652 min
Histogram: 2 1 0 1 0 1 1 1 0 1

Total # of neighbors = 5600
Ave neighs/atom = 25.925926
Neighbor list builds = 10
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -876.903823262972
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -2544.38729278309
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal -10068.1339282533
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -115.024759428644
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 2549.99680933268
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2750.28203361138
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 16032.8930587175
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -3220.90310056816

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 132.615891684017
variable C2pos equal ${d2}
variable C2pos equal 82.4756618929222
variable C3pos equal ${d3}
variable C3pos equal 78.3170763750786
variable C4pos equal ${d4}
variable C4pos equal 14.713432215
variable C5pos equal ${d5}
variable C5pos equal -94.3713885188961
variable C6pos equal ${d6}
variable C6pos equal -7.7157570468998

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(126.778481829785+${C1pos})
variable C11 equal 0.5*(126.778481829785+132.615891684017)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(71.4777796121415+${C2pos})
variable C21 equal 0.5*(71.4777796121415+82.4756618929222)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(81.9581075222585+${C3pos})
variable C31 equal 0.5*(81.9581075222585+78.3170763750786)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-18.2941794183687+${C4pos})
variable C41 equal 0.5*(-18.2941794183687+14.713432215)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(9.42844339171094+${C5pos})
variable C51 equal 0.5*(9.42844339171094+-94.3713885188961)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(6.17309182214525+${C6pos})
variable C61 equal 0.5*(6.17309182214525+-7.7157570468998)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 16.293
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.32586 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.32586 yz delta -0 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 15.96714 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (16.293 15.96714 16.293) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.40932      37377.748      0              0              0              0              0              0            
       100   1910.8456     -872.9435       38342.443      36093.104      45217.356      37052.134     -4882.529      -1970.0856      954.93724    
       200   1966.3365     -869.9188       36965.736      35773.399      43566.391      35418.694      5272.7995     -442.11992     -5873.8217    
       300   2308.9329     -872.52683      37361.689      33137.854      44745.457      35043.314     -9906.4347     -863.17872      521.74461    
       400   2010.0394     -875.89986      35014.123      32250.083      43309.737      32903.466     -5.3068064      883.80851      1037.8832    
       500   2155.8358     -871.3055       41667.363      35432.556      45818.067      36751.215      3510.3082      281.85549     -1785.6351    
       600   1889.1864     -878.90477      36481.871      33599.305      44933.005      36467.326      3627.5769      1694.3901     -636.59935    
       700   1943.4105     -871.72523      35542.054      33916.15       42990.288      35181.044     -1420.9169      4619.8743      2651.1014    
       800   2011.1236     -872.71094      35499.112      33025.748      44741.311      33657.509      932.24348     -2329.1006     -4801.1215    
       900   2000.7424     -870.35838      38608.632      34215.35       43744.69       32186.643      1175.3355     -3788.8919      56.196192    
      1000   2125.807      -875.34704      37091.678      36182.495      44702.309      33438.361     -1558.1269     -3638.4397     -1689.6421    
Loop time of 0.216386 on 8 procs for 1000 steps with 216 atoms

Performance: 399.287 ns/day, 0.060 hours/ns, 4621.372 timesteps/s, 998.216 katom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.10652    | 0.12486    | 0.16314    |   5.7 | 57.70
Neigh   | 0.0014076  | 0.0016456  | 0.0022584  |   0.7 |  0.76
Comm    | 0.041032   | 0.079736   | 0.097906   |   7.2 | 36.85
Output  | 0.00034128 | 0.00036559 | 0.00047424 |   0.0 |  0.17
Modify  | 0.0032798  | 0.0035409  | 0.0041832  |   0.5 |  1.64
Other   |            | 0.006235   |            |       |  2.88

Nlocal:             27 ave          30 max          23 min
Histogram: 1 0 1 0 0 3 0 1 1 1
Nghost:            253 ave         256 max         250 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       709.75 ave         786 max         610 min
Histogram: 1 0 1 0 0 2 1 1 1 1

Total # of neighbors = 5678
Ave neighs/atom = 26.287037
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2125.807      -875.34704      37091.678      0              0              0              0              0              0            
       100   2198.0183     -872.69738      38879.251      34444.704      43408.892      32229.342     -4495.9907      2185.0343     -1409.987     
       200   2049.9011     -874.37424      36684.269      34374.974      43376.41       34178.075     -202.58937     -2374.3234     -4009.9864    
       300   2137.7933     -870.19311      38308.295      35221.972      43544.089      35331.349      78.321482      3784.7224     -1768.6324    
Loop time of 0.0510651 on 8 procs for 300 steps with 216 atoms

Performance: 507.587 ns/day, 0.047 hours/ns, 5874.853 timesteps/s, 1.269 Matom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.03175    | 0.0345     | 0.03685    |   1.1 | 67.56
Neigh   | 0.00042807 | 0.00046647 | 0.00048713 |   0.0 |  0.91
Comm    | 0.011505   | 0.013834   | 0.016516   |   1.7 | 27.09
Output  | 9.5035e-05 | 0.00010075 | 0.00013424 |   0.0 |  0.20
Modify  | 0.0008693  | 0.00091759 | 0.00094036 |   0.0 |  1.80
Other   |            | 0.001247   |            |       |  2.44

Nlocal:             27 ave          30 max          25 min
Histogram: 1 0 2 0 3 0 1 0 0 1
Nghost:            254 ave         257 max         250 min
Histogram: 1 0 0 0 1 3 0 2 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          711 ave         784 max         658 min
Histogram: 1 2 0 1 2 0 1 0 0 1

Total # of neighbors = 5688
Ave neighs/atom = 26.333333
Neighbor list builds = 10
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 93.8346398585075
variable C2neg equal ${d2}
variable C2neg equal 135.819907388119
variable C3neg equal ${d3}
variable C3neg equal 85.58968653005
variable C4neg equal ${d4}
variable C4neg equal -7.45207879960399
variable C5neg equal ${d5}
variable C5neg equal 33.1305351935714
variable C6neg equal ${d6}
variable C6neg equal -5.64404571201776

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.32586 yz delta ${deltayz} remap units box
change_box all y delta 0 0.32586 yz delta 0 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.61886 16.293) with tilt (0 0 0)
  triclinic box = (0 0 0) to (16.293 16.61886 16.293) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.53307     -3258.381       0              0              0              0              0              0            
       100   2139.3565     -872.20735     -1767.1325      2885.3159     -8144.4975      1951.1073     -7338.0235      2607.2119     -2388.9532    
       200   1963.9225     -871.24451     -1707.9446      3645.9067     -10791.387      442.08337     -31.700885      393.49458     -1025.1892    
       300   1889.2864     -875.30238     -1350.7801      1473.8344     -5772.476       3001.0996     -4536.893      -4903.5078      178.14428    
       400   2090.6383     -868.62957     -4369.0013     -749.54368     -7849.6748      733.28482     -3373.5168     -3039.7508      1016.025     
       500   1834.3964     -872.91159     -2981.4894      991.32693     -9095.7931     -356.93132      248.15175     -285.43428      3550.7102    
       600   2116.5251     -872.56072     -2913.8178     -1026.2952     -9266.5902      2934.1633     -4880.5934      1945.7328      994.91631    
       700   2034.7891     -870.99448     -398.38991      506.23894     -9085.8924      1316.3221     -6128.4352      1829.622       2808.4447    
       800   2063.6756     -878.27827      188.60457      1018.8923     -5251.6246      1520.1409     -478.71299      916.10845      3152.0891    
       900   1829.4537     -869.06978     -3751.8179      1357.5158     -8613.8011      668.56398     -2634.633      -196.45254     -565.4468     
      1000   2050.5821     -875.14464     -2310.8775      1919.4761     -8754.5448     -570.56811      1697.7209      5772.6911      670.13626    
Loop time of 0.15197 on 8 procs for 1000 steps with 216 atoms

Performance: 568.534 ns/day, 0.042 hours/ns, 6580.253 timesteps/s, 1.421 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.08295    | 0.093136   | 0.10287    |   2.1 | 61.29
Neigh   | 0.0015139  | 0.0015962  | 0.0017266  |   0.2 |  1.05
Comm    | 0.039739   | 0.049588   | 0.059829   |   2.9 | 32.63
Output  | 0.00030262 | 0.00031928 | 0.00041237 |   0.0 |  0.21
Modify  | 0.0030397  | 0.003096   | 0.0031805  |   0.1 |  2.04
Other   |            | 0.004235   |            |       |  2.79

Nlocal:             27 ave          30 max          24 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Nghost:          252.5 ave         255 max         250 min
Histogram: 1 0 1 0 2 0 2 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          688 ave         767 max         598 min
Histogram: 1 0 1 1 0 2 0 1 1 1

Total # of neighbors = 5504
Ave neighs/atom = 25.481481
Neighbor list builds = 34
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2050.5821     -875.14464     -2310.8775      0              0              0              0              0              0            
       100   2075.6088     -869.80065     -956.31295      2349.561      -8149.8301     -84.455929      1812.1531     -3508.1264      306.57664    
       200   2181.0053     -875.44224     -598.04264      1772.3708     -8913.4912      1178.229       1373.559       1877.6055     -296.72211    
       300   2055.8242     -874.2108      -708.32698      3054.4941     -7392.0751     -23.131077     -1078.8627     -2357.6929      1970.2099    
Loop time of 0.0482136 on 8 procs for 300 steps with 216 atoms

Performance: 537.607 ns/day, 0.045 hours/ns, 6222.307 timesteps/s, 1.344 Matom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.024534   | 0.028318   | 0.037524   |   2.2 | 58.73
Neigh   | 0.00039925 | 0.00042569 | 0.00048073 |   0.0 |  0.88
Comm    | 0.0080359  | 0.017112   | 0.020684   |   2.8 | 35.49
Output  | 9.6532e-05 | 0.0001015  | 0.00013076 |   0.0 |  0.21
Modify  | 0.00089575 | 0.00094155 | 0.00099133 |   0.0 |  1.95
Other   |            | 0.001315   |            |       |  2.73

Nlocal:             27 ave          31 max          23 min
Histogram: 1 0 0 2 0 2 2 0 0 1
Nghost:          252.5 ave         256 max         249 min
Histogram: 1 0 0 0 3 3 0 0 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       697.75 ave         802 max         582 min
Histogram: 1 0 0 0 2 2 2 0 0 1

Total # of neighbors = 5582
Ave neighs/atom = 25.842593
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -874.210802821295
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -708.326980976382
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 5771.08053204271
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal -7046.78043689355
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -849.281038078303
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -4402.3508408312
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 2434.5737261497
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 3100.83607247954

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 53.4198193825364
variable C2pos equal ${d2}
variable C2pos equal 117.134440280247
variable C3pos equal ${d3}
variable C3pos equal 95.3134656121335
variable C4pos equal ${d4}
variable C4pos equal -16.8952636502385
variable C5pos equal ${d5}
variable C5pos equal -26.3797918560572
variable C6pos equal ${d6}
variable C6pos equal 28.0474073253131

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(93.8346398585075+${C1pos})
variable C12 equal 0.5*(93.8346398585075+53.4198193825364)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(135.819907388119+${C2pos})
variable C22 equal 0.5*(135.819907388119+117.134440280247)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(85.58968653005+${C3pos})
variable C32 equal 0.5*(85.58968653005+95.3134656121335)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-7.45207879960399+${C4pos})
variable C42 equal 0.5*(-7.45207879960399+-16.8952636502385)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(33.1305351935714+${C5pos})
variable C52 equal 0.5*(33.1305351935714+-26.3797918560572)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-5.64404571201776+${C6pos})
variable C62 equal 0.5*(-5.64404571201776+28.0474073253131)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.293
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 15.96714) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.21334      37512.943      0              0              0              0              0              0            
       100   2020.1713     -875.93159      37340.231      36221.71       35070.318      46902.065     -4118.3658     -2515.6754     -578.17259    
       200   2003.6883     -867.8618       38351.943      32291.124      33152.706      42390.349      1341.1741      3178.7716      4446.3261    
       300   2052.4929     -876.19574      35534.142      31880.917      31758.27       43576.072      1580.23       -16.14655       492.27551    
       400   2085.3287     -864.81387      39866.29       33867.613      34553.744      43323.505      1031.2374      537.94457      23.573487    
       500   1853.47       -870.43664      37863.103      32715.03       36369.429      47767.014      1661.7202      421.53917     -2654.3571    
       600   1853.5638     -871.01914      34838.078      30835.152      33297.018      43616.792     -2081.9348     -1974.1991     -2777.5375    
       700   1870.8517     -865.10653      38731.136      31827.904      35409.969      44814.902      4333.0297      2192.0581      9110.3152    
       800   2097.9209     -867.79095      36958.229      33504.793      33143.922      40379.892      4095.5799     -2406.0806     -1262.7911    
       900   2041.1975     -870.56025      38201.82       33796.821      33327.256      40981.432     -384.55054      4006.9438     -1452.2077    
      1000   1882.0311     -877.36464      37254.128      31991.55       33743.575      41253.196      3187.6483     -1165.6553      5282.0272    
Loop time of 0.215263 on 8 procs for 1000 steps with 216 atoms

Performance: 401.370 ns/day, 0.060 hours/ns, 4645.481 timesteps/s, 1.003 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.10113    | 0.12541    | 0.16219    |   6.2 | 58.26
Neigh   | 0.0014213  | 0.0016575  | 0.0021855  |   0.7 |  0.77
Comm    | 0.042442   | 0.079      | 0.10365    |   7.8 | 36.70
Output  | 0.00032857 | 0.00035034 | 0.0004521  |   0.0 |  0.16
Modify  | 0.0032343  | 0.0034221  | 0.0037802  |   0.3 |  1.59
Other   |            | 0.005426   |            |       |  2.52

Nlocal:             27 ave          29 max          24 min
Histogram: 1 0 1 0 1 0 1 0 2 2
Nghost:          252.5 ave         255 max         251 min
Histogram: 4 0 1 0 0 0 0 1 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        716.5 ave         767 max         635 min
Histogram: 1 1 0 0 1 0 1 0 2 2

Total # of neighbors = 5732
Ave neighs/atom = 26.537037
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   1882.0311     -877.36464      37254.128      0              0              0              0              0              0            
       100   2120.8183     -877.71433      36654.622      34222.928      35679.57       45341.298     -995.79657     -1321.5174      483.11244    
       200   2119.004      -873.98078      40547.143      34856.313      35353.373      45921.716      76.382779      82.129105      4068.8093    
       300   2080.9607     -868.44399      36628.551      33374.988      35862.838      44970.808     -1348.7993     -5540.9539      1057.0263    
Loop time of 0.0521018 on 8 procs for 300 steps with 216 atoms

Performance: 497.487 ns/day, 0.048 hours/ns, 5757.957 timesteps/s, 1.244 Matom-step/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.031123   | 0.035198   | 0.038493   |   1.1 | 67.56
Neigh   | 0.00045682 | 0.00047355 | 0.00051905 |   0.0 |  0.91
Comm    | 0.010665   | 0.014059   | 0.018137   |   1.7 | 26.98
Output  | 9.2656e-05 | 9.9844e-05 | 0.00013259 |   0.0 |  0.19
Modify  | 0.00093764 | 0.00096652 | 0.0010051  |   0.0 |  1.86
Other   |            | 0.001305   |            |       |  2.50

Nlocal:             27 ave          28 max          26 min
Histogram: 2 0 0 0 0 4 0 0 0 2
Nghost:         252.25 ave         254 max         250 min
Histogram: 1 0 2 0 0 1 0 2 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        705.5 ave         738 max         672 min
Histogram: 2 0 0 0 0 3 1 1 0 1

Total # of neighbors = 5644
Ave neighs/atom = 26.12963
Neighbor list builds = 10
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 84.599716335537
variable C2neg equal ${d2}
variable C2neg equal 97.4136498432355
variable C3neg equal ${d3}
variable C3neg equal 133.78697948176
variable C4neg equal ${d4}
variable C4neg equal 6.67621500180911
variable C5neg equal ${d5}
variable C5neg equal -13.4978460491055
variable C6neg equal ${d6}
variable C6neg equal -12.7796493760372

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.61886) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.70454     -3466.7566      0              0              0              0              0              0            
       100   2141.1639     -872.24265     -1537.713       3055.8272      2369.8015     -8376.7869     -7651.1517      2687.9704     -2384.8926    
       200   1930.9451     -875.44062     -1235.0036      3114.6244     -150.62721     -9442.4116     -1359.0405      81.715685     -868.0209     
       300   1907.694      -881.5245      -2498.0483      2680.8363      1808.154      -6954.6054     -931.18254      3331.5766     -4628.656     
       400   2106.695      -873.70705      1805.599       3362.4256      3117.8017     -5365.4121      697.20735      1785.0535     -899.96285    
       500   2066.5646     -876.2783       858.54749      4167.1831      4070.2825     -7369.3989      1465.3171      3943.3239      961.6446     
       600   1990.0962     -876.14247     -3884.3061      1559.4422      3398.9942     -7112.6205     -2250.7823     -2593.2169     -3042.3878    
       700   1979.0935     -871.98938     -5745.4028     -1282.1423     -1867.8675     -10432.692      4443.8828     -3619.8319      3331.6841    
       800   2098.0043     -871.0267      -1623.3799      941.00755     -1397.7726     -11624.351      2101.5871      2406.2576     -4844.1436    
       900   2065.0153     -875.08763     -2257.2899      749.35936     -374.30122     -8781.6818      1840.4145      2455.9876      2256.6294    
      1000   1856.5558     -869.71944      143.06916      1198.1346      2967.7402     -8086.5782     -191.61096     -709.68712     -851.18748    
Loop time of 0.152673 on 8 procs for 1000 steps with 216 atoms

Performance: 565.914 ns/day, 0.042 hours/ns, 6549.928 timesteps/s, 1.415 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.087772   | 0.092625   | 0.10224    |   1.6 | 60.67
Neigh   | 0.0014897  | 0.0015671  | 0.001754   |   0.2 |  1.03
Comm    | 0.04103    | 0.050699   | 0.055688   |   2.2 | 33.21
Output  | 0.00030523 | 0.00032446 | 0.00042803 |   0.0 |  0.21
Modify  | 0.0030325  | 0.0031018  | 0.0031955  |   0.1 |  2.03
Other   |            | 0.004357   |            |       |  2.85

Nlocal:             27 ave          29 max          24 min
Histogram: 1 0 0 0 1 0 3 0 2 1
Nghost:          252.5 ave         256 max         250 min
Histogram: 1 1 0 3 0 1 1 0 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        698.5 ave         747 max         605 min
Histogram: 1 0 0 0 1 0 1 2 2 1

Total # of neighbors = 5588
Ave neighs/atom = 25.87037
Neighbor list builds = 33
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   1856.5558     -869.71944      143.06916      0              0              0              0              0              0            
       100   2039.8611     -878.31237     -2290.3434      2652.47        1648.2449     -8144.9984     -3958.0739      1801.2303     -2188.9225    
       200   2289.3744     -874.63206      2123.0554      3011.1592      2975.4947     -7049.7933      337.30257      2831.3804     -2294.7206    
       300   1947.9247     -877.50216     -1205.1685      2900.7325      3639.6224     -8391.5136      4640.5932      69.169389     -1030.5577    
Loop time of 0.0449104 on 8 procs for 300 steps with 216 atoms

Performance: 577.150 ns/day, 0.042 hours/ns, 6679.972 timesteps/s, 1.443 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.025873   | 0.027821   | 0.02963    |   0.7 | 61.95
Neigh   | 0.00041219 | 0.00042944 | 0.00045057 |   0.0 |  0.96
Comm    | 0.01257    | 0.014358   | 0.016283   |   1.0 | 31.97
Output  | 8.8746e-05 | 9.5041e-05 | 0.0001268  |   0.0 |  0.21
Modify  | 0.00090291 | 0.00092635 | 0.00095827 |   0.0 |  2.06
Other   |            | 0.00128    |            |       |  2.85

Nlocal:             27 ave          30 max          24 min
Histogram: 1 1 0 0 0 3 2 0 0 1
Nghost:            252 ave         254 max         249 min
Histogram: 1 0 0 0 1 0 3 0 2 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          702 ave         787 max         603 min
Histogram: 1 0 0 1 0 3 0 2 0 1

Total # of neighbors = 5616
Ave neighs/atom = 26
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -877.502164165056
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal -1205.16848044517
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 4881.5759815286
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 1343.31098400171
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal -9840.3924068658
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 11346.772315561
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal 4305.90135884705
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 1115.26092542026

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 57.867342135107
variable C2pos equal ${d2}
variable C2pos equal 75.1839831757705
variable C3pos equal ${d3}
variable C3pos equal 140.269022456071
variable C4pos equal ${d4}
variable C4pos equal -6.96738791494211
variable C5pos equal ${d5}
variable C5pos equal -35.7364300195439
variable C6pos equal ${d6}
variable C6pos equal -50.6982084566479

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(84.599716335537+${C1pos})
variable C13 equal 0.5*(84.599716335537+57.867342135107)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(97.4136498432355+${C2pos})
variable C23 equal 0.5*(97.4136498432355+75.1839831757705)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(133.78697948176+${C3pos})
variable C33 equal 0.5*(133.78697948176+140.269022456071)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(6.67621500180911+${C4pos})
variable C43 equal 0.5*(6.67621500180911+-6.96738791494211)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-13.4978460491055+${C5pos})
variable C53 equal 0.5*(-13.4978460491055+-35.7364300195439)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-12.7796493760372+${C6pos})
variable C63 equal 0.5*(-12.7796493760372+-50.6982084566479)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.293
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 -0.32586)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.17601      16633.717      0              0              0              0              0              0            
       100   1885.9648     -874.39924      17706.164      18650.029      17412.414      18999.503     -3668.2731     -986.84577      8683.7311    
       200   1931.2405     -873.5182       19250.582      21002.293      18184.164      16986.134      582.88667      2017.0488      10083.965    
       300   2020.6632     -870.71457      15444.132      15005.491      15533.194      15313.569     -4040.9278      1057.5595      5664.3008    
       400   1997.5972     -875.44531      15544.918      14170.377      15386.799      16926.213      1401.9339     -1775.6645      6148.0222    
       500   1907.065      -871.2183       16147.184      16675.83       14080.718      16801.895      3401.3092     -1255.5568      10897.125    
       600   1957.5032     -875.77649      16003.469      16156.458      16143.67       18418.188     -1704.3237     -1978.6937      14090.333    
       700   1860.1901     -878.23911      12942.36       16054.608      17912.644      15063.976     -1904.2604     -1290.3264      7470.7998    
       800   2082.6772     -871.24561      16745.081      15607.457      16299.451      13658.429     -882.52448     -476.43584      7115.0402    
       900   2057.2586     -871.23371      17205.662      18112.994      15518.215      14291.635     -464.59705     -4076.92        8075.6363    
      1000   2029.2712     -882.60085      15665.711      20226.818      15720.864      15006.728     -1847.1578     -4634.3469      12062.851    
Loop time of 0.162729 on 8 procs for 1000 steps with 216 atoms

Performance: 530.945 ns/day, 0.045 hours/ns, 6145.195 timesteps/s, 1.327 Matom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.096156   | 0.10407    | 0.1136     |   1.6 | 63.95
Neigh   | 0.0014361  | 0.0015277  | 0.0016604  |   0.2 |  0.94
Comm    | 0.039929   | 0.049302   | 0.057002   |   2.3 | 30.30
Output  | 0.00031578 | 0.00033222 | 0.00043368 |   0.0 |  0.20
Modify  | 0.0030458  | 0.0031194  | 0.0032745  |   0.1 |  1.92
Other   |            | 0.004381   |            |       |  2.69

Nlocal:             27 ave          29 max          25 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Nghost:          252.5 ave         254 max         250 min
Histogram: 1 0 1 0 0 1 0 3 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       705.75 ave         776 max         633 min
Histogram: 1 0 1 1 0 2 1 1 0 1

Total # of neighbors = 5646
Ave neighs/atom = 26.138889
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2029.2712     -882.60085      15665.711      0              0              0              0              0              0            
       100   2120.1375     -877.58708      18631.483      19719.429      16091.67       16438.05      -1566.0797     -103.46008      11129.092    
       200   2009.2774     -874.41246      16655.499      16656.358      15902.419      17002.502     -4256.7192     -2590.2215      5046.8193    
       300   2073.2419     -877.20665      20856.703      16562.9        18805.286      19351.651     -1483.4752     -1117.3159      2058.9713    
Loop time of 0.0512433 on 8 procs for 300 steps with 216 atoms

Performance: 505.822 ns/day, 0.047 hours/ns, 5854.422 timesteps/s, 1.265 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.027069   | 0.031507   | 0.03899    |   2.2 | 61.49
Neigh   | 0.00041202 | 0.00043668 | 0.00050991 |   0.0 |  0.85
Comm    | 0.0094305  | 0.016877   | 0.021224   |   2.9 | 32.93
Output  | 9.3261e-05 | 9.8514e-05 | 0.00012843 |   0.0 |  0.19
Modify  | 0.00092394 | 0.00095767 | 0.0010405  |   0.0 |  1.87
Other   |            | 0.001367   |            |       |  2.67

Nlocal:             27 ave          29 max          26 min
Histogram: 2 0 0 5 0 0 0 0 0 1
Nghost:            253 ave         256 max         250 min
Histogram: 1 1 0 1 0 1 3 0 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       711.75 ave         767 max         683 min
Histogram: 1 2 1 2 0 1 0 0 0 1

Total # of neighbors = 5694
Ave neighs/atom = 26.361111
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.539278018780515
variable C2neg equal ${d2}
variable C2neg equal 12.125890736521
variable C3neg equal ${d3}
variable C3neg equal 5.6911931412955
variable C4neg equal ${d4}
variable C4neg equal 11.6859397260587
variable C5neg equal ${d5}
variable C5neg equal 8.6203438903386
variable C6neg equal ${d6}
variable C6neg equal -13.4530291822064

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0.32586)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -876.1916       16184.573      0              0              0              0              0              0            
       100   2084.6289     -866.89653      15827.375      18240.153      16980.887      18080.323     -5855.2777      815.76339     -8236.5454    
       200   1903.1287     -869.69218      15291.893      17621.738      17110.585      13153.503     -1201.0506      2683.4431     -12641.787    
       300   2038.4635     -870.87121      12937.674      15836.765      16221.603      14257.466      1714.5774      2342.5866     -12719.37     
       400   2212.6717     -872.91948      17741.274      15477.085      15442.348      15674.315      5594.1357     -4225.176      -6552.706     
       500   1949.7377     -873.19837      15426.667      14821.759      16593.664      16006.429      2342.1561      2303.391      -6545.5374    
       600   2041.847      -869.52821      18837.446      16176.602      15991.456      16763.812      279.0691      -6146.0368     -9066.5232    
       700   2058.4546     -873.30865      17050.855      14148.774      15601.093      18180.671      1046.1365      1831.3652     -13161.173    
       800   2138.7372     -877.7795       17859.018      17219.646      17133.611      17567.004     -631.53158     -1695.7452     -2227.032     
       900   2189.9067     -876.22451      16880.325      16510.933      17455.165      17706.862     -981.65272     -1273.5514     -3175.0063    
      1000   2014.9952     -873.61882      18427.371      16431.256      16565.75       17462.983     -3147.5314      2035.04       -607.10353    
Loop time of 0.176548 on 8 procs for 1000 steps with 216 atoms

Performance: 489.384 ns/day, 0.049 hours/ns, 5664.172 timesteps/s, 1.223 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.095223   | 0.10736    | 0.12408    |   2.4 | 60.81
Neigh   | 0.0014176  | 0.0015202  | 0.0018014  |   0.3 |  0.86
Comm    | 0.042332   | 0.059323   | 0.071376   |   3.3 | 33.60
Output  | 0.00031878 | 0.00034248 | 0.00046172 |   0.0 |  0.19
Modify  | 0.0030821  | 0.0032098  | 0.0034055  |   0.2 |  1.82
Other   |            | 0.00479    |            |       |  2.71

Nlocal:             27 ave          28 max          25 min
Histogram: 1 0 0 2 0 0 1 0 0 4
Nghost:            253 ave         255 max         251 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          703 ave         739 max         651 min
Histogram: 1 0 2 0 0 1 0 0 1 3

Total # of neighbors = 5624
Ave neighs/atom = 26.037037
Neighbor list builds = 31
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2014.9952     -873.61882      18427.371      0              0              0              0              0              0            
       100   1942.7483     -875.90807      18173.247      18868.79       16747.447      17234.855      1658.6997      321.51127     -13242.384    
       200   2005.8266     -878.6052       15754.511      16492.504      15818.05       18020.639      9926.1579      2948.0344     -7897.0317    
       300   1942.1305     -875.05399      17377.209      16763.472      17421.857      17049.72      -2962.377      -1510.7793     -7970.8703    
Loop time of 0.047861 on 8 procs for 300 steps with 216 atoms

Performance: 541.568 ns/day, 0.044 hours/ns, 6268.151 timesteps/s, 1.354 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.028652   | 0.030965   | 0.03255    |   0.8 | 64.70
Neigh   | 0.00040178 | 0.00043183 | 0.00046299 |   0.0 |  0.90
Comm    | 0.01248    | 0.014122   | 0.016493   |   1.2 | 29.51
Output  | 9.6611e-05 | 0.0001026  | 0.00013504 |   0.0 |  0.21
Modify  | 0.00091486 | 0.00093348 | 0.00094959 |   0.0 |  1.95
Other   |            | 0.001306   |            |       |  2.73

Nlocal:             27 ave          28 max          26 min
Histogram: 2 0 0 0 0 4 0 0 0 2
Nghost:         251.75 ave         254 max         250 min
Histogram: 2 0 1 0 0 3 0 1 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          705 ave         729 max         667 min
Histogram: 1 0 0 1 0 2 0 1 2 1

Total # of neighbors = 5640
Ave neighs/atom = 26.111111
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -875.053994839649
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 17377.2092525721
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 18099.5772256947
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 17068.2952432153
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 16963.7552888064
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 3838.35560145347
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -6435.73894139581
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal -4737.75419349877

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -8.2226640857235
variable C2pos equal ${d2}
variable C2pos equal -3.4409381202975
variable C3pos equal ${d3}
variable C3pos equal 6.24828397771002
variable C4pos equal ${d4}
variable C4pos equal 22.297687679653
variable C5pos equal ${d5}
variable C5pos equal 17.9717714816704
variable C6pos equal ${d6}
variable C6pos equal -13.1561248861103

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(0.539278018780515+${C1pos})
variable C14 equal 0.5*(0.539278018780515+-8.2226640857235)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(12.125890736521+${C2pos})
variable C24 equal 0.5*(12.125890736521+-3.4409381202975)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(5.6911931412955+${C3pos})
variable C34 equal 0.5*(5.6911931412955+6.24828397771002)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(11.6859397260587+${C4pos})
variable C44 equal 0.5*(11.6859397260587+22.297687679653)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(8.6203438903386+${C5pos})
variable C54 equal 0.5*(8.6203438903386+17.9717714816704)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-13.4530291822064+${C6pos})
variable C64 equal 0.5*(-13.4530291822064+-13.1561248861103)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.293
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 -0.32586 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.94147      16548.946      0              0              0              0              0              0            
       100   1993.7497     -873.24418      16336.847      17350.526      17861.854      18430.173     -8386.15        12825.557     -226.37326    
       200   1885.3642     -873.99437      18238.004      14685.328      17027.438      15282.945     -29.363314      9390.453       4279.3921    
       300   2050.1207     -874.55774      17550.203      16716.511      17941.92       17475.164     -1904.1298      10484.889     -2352.0839    
       400   2114.0305     -877.15539      18187.505      16250.396      18393.991      15021.137      2469.6376      8262.3407     -114.09981    
       500   2100.3531     -872.74145      17983.446      15949.054      20850.847      18921.9       -124.74863      7518.3699     -1765.1186    
       600   2196.509      -869.43323      16794.299      14471.941      17434.009      17092.266      954.76238      13574.872     -1459.1839    
       700   2252.6798     -868.94772      20757.224      17055.777      16844.817      17671.443     -6935.4337      7682.4205      1767.7579    
       800   1984.2633     -878.30763      16620.442      15520.779      14431.789      16538.903     -3040.4329      4121.6208     -2075.652     
       900   1941.9855     -873.97828      13347.994      15005.589      17824.79       14287.308     -3590.3158      533.3161      -114.71843    
      1000   1902.0802     -872.75016      14293.369      13474.307      16259.378      15844.951      748.27268      6946.8932     -2700.7355    
Loop time of 0.165721 on 8 procs for 1000 steps with 216 atoms

Performance: 521.359 ns/day, 0.046 hours/ns, 6034.251 timesteps/s, 1.303 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.098297   | 0.10479    | 0.11043    |   1.3 | 63.24
Neigh   | 0.0015063  | 0.0015753  | 0.0016762  |   0.1 |  0.95
Comm    | 0.045965   | 0.05154    | 0.057986   |   1.9 | 31.10
Output  | 0.0003177  | 0.00033672 | 0.00044985 |   0.0 |  0.20
Modify  | 0.0030767  | 0.0031332  | 0.0031848  |   0.1 |  1.89
Other   |            | 0.004341   |            |       |  2.62

Nlocal:             27 ave          30 max          25 min
Histogram: 3 0 0 0 1 0 3 0 0 1
Nghost:          252.5 ave         255 max         249 min
Histogram: 1 1 0 0 0 2 1 0 1 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          705 ave         779 max         638 min
Histogram: 2 1 0 0 0 2 2 0 0 1

Total # of neighbors = 5640
Ave neighs/atom = 26.111111
Neighbor list builds = 33
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   1902.0802     -872.75016      14293.369      0              0              0              0              0              0            
       100   1965.9123     -871.75413      15229.18       13338.327      12519.412      13406.193     -4513.9059      6533.7896      268.85163    
       200   2079.0412     -874.23742      18044.187      16824.129      16378.813      16239.803     -2734.5226      6993.5646      4339.6189    
       300   2026.7989     -877.96083      18031.566      15854.112      18305.583      17243.822      500.00498      5238.9019     -6005.2901    
Loop time of 0.0520572 on 8 procs for 300 steps with 216 atoms

Performance: 497.913 ns/day, 0.048 hours/ns, 5762.887 timesteps/s, 1.245 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.027521   | 0.031674   | 0.03817    |   1.8 | 60.85
Neigh   | 0.00039066 | 0.00042524 | 0.00049442 |   0.0 |  0.82
Comm    | 0.011133   | 0.017583   | 0.021721   |   2.4 | 33.78
Output  | 9.1292e-05 | 9.7996e-05 | 0.00013413 |   0.0 |  0.19
Modify  | 0.00089937 | 0.00094462 | 0.00099743 |   0.0 |  1.81
Other   |            | 0.001332   |            |       |  2.56

Nlocal:             27 ave          29 max          23 min
Histogram: 1 0 0 0 0 3 0 0 1 3
Nghost:          252.5 ave         256 max         250 min
Histogram: 1 2 0 1 0 2 1 0 0 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          704 ave         765 max         589 min
Histogram: 1 0 0 0 2 1 0 0 1 3

Total # of neighbors = 5632
Ave neighs/atom = 26.074074
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -3.00466360725449
variable C2neg equal ${d2}
variable C2neg equal 9.62737551687999
variable C3neg equal ${d3}
variable C3neg equal -4.8479479612035
variable C4neg equal ${d4}
variable C4neg equal -28.6353671097233
variable C5neg equal ${d5}
variable C5neg equal 40.4014328067737
variable C6neg equal ${d6}
variable C6neg equal -3.53562822105909

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0.32586 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.39817      16331.084      0              0              0              0              0              0            
       100   1771.5891     -877.02565      15589.751      16954.446      17945.41       19172.462     -4700.5119     -12165.412      90.686476    
       200   2062.8505     -875.20016      18591.651      16673.782      16550.305      19024.678      3046.3125     -10305.77      -604.25334    
       300   1986.871      -872.77378      16332.39       16432.418      15688.264      16720.279      1336.0036     -9436.8832     -1297.3657    
       400   1977.4563     -878.1829       13830.189      16982.214      15992.752      17066.168     -4554.5264     -9386.1254     -5277.3851    
       500   2117.4156     -875.26249      17857.43       16618.012      18666.99       18251.908     -1235.4891     -6029.999       1148.2825    
       600   2005.9298     -872.68374      15174.549      15410.565      15775.225      15958.045      1487.6797     -8764.4647     -5065.0198    
       700   2196.0891     -871.00047      15288.433      11228.768      14911.717      14009.235      1437.4408     -5503.6272      1690.4623    
       800   1917.9384     -874.47935      13823.517      14399.786      13797.739      15420.179      876.38832     -7425.6747     -375.1397     
       900   1790.5404     -873.47206      14431.365      14173.34       16791.688      17915.185     -1927.1857     -7935.077      -642.23436    
      1000   2061.1564     -875.21488      16333.905      18174.633      17986.543      16879.18      -2636.9808     -16617.214     -8747.2106    
Loop time of 0.167881 on 8 procs for 1000 steps with 216 atoms

Performance: 514.651 ns/day, 0.047 hours/ns, 5956.604 timesteps/s, 1.287 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.095803   | 0.10506    | 0.11339    |   2.0 | 62.58
Neigh   | 0.0014507  | 0.0015325  | 0.0016337  |   0.2 |  0.91
Comm    | 0.045082   | 0.053517   | 0.062991   |   2.8 | 31.88
Output  | 0.00031431 | 0.0003377  | 0.00045246 |   0.0 |  0.20
Modify  | 0.0030295  | 0.0031336  | 0.0032092  |   0.1 |  1.87
Other   |            | 0.004302   |            |       |  2.56

Nlocal:             27 ave          29 max          25 min
Histogram: 2 0 1 0 0 2 0 1 0 2
Nghost:          252.5 ave         255 max         250 min
Histogram: 2 0 1 0 0 0 2 0 2 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       701.75 ave         753 max         640 min
Histogram: 2 0 0 1 0 2 0 0 1 2

Total # of neighbors = 5614
Ave neighs/atom = 25.990741
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2061.1564     -875.21488      16333.905      0              0              0              0              0              0            
       100   2137.369      -869.29731      16665.048      16500.347      18469.371      14504.848      3027.3757     -4273.1786      6243.2089    
       200   1962.4862     -876.19926      15750.026      16368.772      18605.726      16625.218      3670.312      -7011.4855      182.87074    
       300   2255.3526     -873.78733      16528.345      15695.556      18776.186      18137.558      298.97672     -7330.8947      171.44274    
Loop time of 0.0479844 on 8 procs for 300 steps with 216 atoms

Performance: 540.175 ns/day, 0.044 hours/ns, 6252.031 timesteps/s, 1.350 Matom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.026895   | 0.031034   | 0.036339   |   1.6 | 64.68
Neigh   | 0.00038798 | 0.00042624 | 0.00045823 |   0.0 |  0.89
Comm    | 0.0089561  | 0.014143   | 0.018187   |   2.4 | 29.47
Output  | 9.4131e-05 | 0.00010008 | 0.0001311  |   0.0 |  0.21
Modify  | 0.00089579 | 0.00093817 | 0.00097507 |   0.0 |  1.96
Other   |            | 0.001342   |            |       |  2.80

Nlocal:             27 ave          29 max          24 min
Histogram: 1 0 1 0 2 0 0 0 1 3
Nghost:          252.5 ave         255 max         250 min
Histogram: 1 0 2 0 1 0 1 0 2 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        706.5 ave         765 max         632 min
Histogram: 1 1 0 2 0 0 0 1 0 3

Total # of neighbors = 5652
Ave neighs/atom = 26.166667
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -873.787333464306
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 16528.3452432678
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 14281.3270075584
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 16964.1783701299
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 18339.5303521152
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal 2093.9898309769
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2261.49317505612
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 7121.91160367708

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 10.868587004958
variable C2pos equal ${d2}
variable C2pos equal -2.92035375487049
variable C3pos equal ${d3}
variable C3pos equal -0.630591338833983
variable C4pos equal ${d4}
variable C4pos equal -37.0006413062262
variable C5pos equal ${d5}
variable C5pos equal -2.89945735002805
variable C6pos equal ${d6}
variable C6pos equal -4.4342960337274

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-3.00466360725449+${C1pos})
variable C15 equal 0.5*(-3.00466360725449+10.868587004958)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(9.62737551687999+${C2pos})
variable C25 equal 0.5*(9.62737551687999+-2.92035375487049)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-4.8479479612035+${C3pos})
variable C35 equal 0.5*(-4.8479479612035+-0.630591338833983)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-28.6353671097233+${C4pos})
variable C45 equal 0.5*(-28.6353671097233+-37.0006413062262)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(40.4014328067737+${C5pos})
variable C55 equal 0.5*(40.4014328067737+-2.89945735002805)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-3.53562822105909+${C6pos})
variable C65 equal 0.5*(-3.53562822105909+-4.4342960337274)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 16.293

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.000 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.02*${len0}
variable delta equal -0.02*16.293
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.02*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.02*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (-0.32586 0 0)

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -876.27924      16542.497      0              0              0              0              0              0            
       100   2098.1092     -871.30997      16465.823      17414.895      15954.538      17246.987      5456.5754     -2884.8042     -1898.7959    
       200   2213.3905     -872.37839      18046.769      18311.058      16246.245      17100.333      5400.3287      1983.9745     -12.489828    
       300   1926.7937     -874.76747      15794.018      16238.415      13747.116      15534.098      6340.5545      4201.5764     -575.96246    
       400   2008.97       -879.00388      18237.502      17498.069      20921.968      17625.693      8652.998       2469.1269     -2958.3099    
       500   2067.3825     -876.38736      17101.565      17363.743      18580.118      17573.61       4570.5624     -1498.561      -3217.3058    
       600   1889.1326     -864.96522      16632.14       14939.66       16641.899      19642.873      7283.5161      445.63861     -1705.89      
       700   2061.142      -870.59122      16748.401      15529.864      16701.067      15806.987      8924.2225     -5201.7973      922.22891    
       800   2040.1502     -870.23596      15080.948      16914.2        15628.35       17070.154      15063.389     -754.62452      2659.2422    
       900   1885.1472     -867.7533       15824.778      15114.707      16685.087      17007.733      8677.7423     -55.462446      4212.5047    
      1000   2124.6323     -882.18062      16477.738      16290.433      13694.579      14968.16       8609.7831     -1866.8578      4111.5319    
Loop time of 0.166342 on 8 procs for 1000 steps with 216 atoms

Performance: 519.413 ns/day, 0.046 hours/ns, 6011.726 timesteps/s, 1.299 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.093246   | 0.10525    | 0.1154     |   2.1 | 63.28
Neigh   | 0.0014216  | 0.0015362  | 0.0016843  |   0.2 |  0.92
Comm    | 0.04154    | 0.051691   | 0.063882   |   2.9 | 31.07
Output  | 0.00030766 | 0.00032806 | 0.00044413 |   0.0 |  0.20
Modify  | 0.0030215  | 0.0031575  | 0.0032498  |   0.2 |  1.90
Other   |            | 0.004375   |            |       |  2.63

Nlocal:             27 ave          29 max          24 min
Histogram: 2 0 0 0 1 0 0 0 3 2
Nghost:            253 ave         256 max         251 min
Histogram: 2 0 3 0 0 0 0 0 2 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       707.25 ave         769 max         623 min
Histogram: 2 0 0 0 1 0 0 3 1 1

Total # of neighbors = 5658
Ave neighs/atom = 26.194444
Neighbor list builds = 32
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2124.6323     -882.18062      16477.738      0              0              0              0              0              0            
       100   1929.4834     -874.61832      15170.362      17254.168      16714.24       14101.601      4488.0921      2984.3873     -7158.01      
       200   1991.3938     -876.26947      15928.967      15121.61       15293.254      17891.958      4726.1353     -1354.3277     -3941.7851    
       300   2109.3814     -869.30127      15267.071      16615.958      15718.986      16484.1        4629.7964      897.61775      2107.063     
Loop time of 0.0488738 on 8 procs for 300 steps with 216 atoms

Performance: 530.346 ns/day, 0.045 hours/ns, 6138.260 timesteps/s, 1.326 Matom-step/s
100.0% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.02825    | 0.031309   | 0.034737   |   1.3 | 64.06
Neigh   | 0.0003596  | 0.00037853 | 0.00041275 |   0.0 |  0.77
Comm    | 0.011402   | 0.014782   | 0.017822   |   1.8 | 30.25
Output  | 0.00010046 | 0.00010776 | 0.00013892 |   0.0 |  0.22
Modify  | 0.0009113  | 0.0009579  | 0.00099644 |   0.0 |  1.96
Other   |            | 0.001339   |            |       |  2.74

Nlocal:             27 ave          30 max          24 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Nghost:            253 ave         256 max         250 min
Histogram: 1 0 0 3 0 1 1 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       698.75 ave         769 max         612 min
Histogram: 1 0 1 1 0 1 1 1 0 2

Total # of neighbors = 5590
Ave neighs/atom = 25.87963
Neighbor list builds = 8
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.804567412432007
variable C2neg equal ${d2}
variable C2neg equal -3.305607322743
variable C3neg equal ${d3}
variable C3neg equal -8.64656039209351
variable C4neg equal ${d4}
variable C4neg equal 11.9263984276047
variable C5neg equal ${d5}
variable C5neg equal 18.695011992496
variable C6neg equal ${d6}
variable C6neg equal 17.1133287609126

# Reset box and simulation parameters

clear
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 28 Mar 2023, LAMMPS = 28 Mar 2023
  restoring atom style atomic from restart
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  pair style sw stores no restart info
  216 atoms
  read_restart CPU = 0.001 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.02*${len0}
variable delta equal 0.02*16.293
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.02*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.02*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.02*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.32586 remap units box
Changing box ...
  triclinic box = (0 0 0) to (16.293 16.293 16.293) with tilt (0.32586 0 0)

# Run MD

run ${nequil}
run 1000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.77118
  ghost atom cutoff = 4.77118
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair sw, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   2155.8855     -875.06342      16432.049      0              0              0              0              0              0            
       100   1986.2191     -872.00576      15962.876      18811.692      14983.974      18064.002     -9409.6206      2518.1744      2652.1144    
       200   1990.5781     -873.27844      16428.981      15217.499      16407.459      17512.836     -7965.0439      5590.1065     -1084.439     
       300   1968.1423     -872.59825      17890.37       14793.096      17457.065      17876.309     -5551.6039     -2458.4108     -2502.0873    
       400   1893.7173     -877.85565      16406.31       17327.355      16332.595      15153.219     -8402.7988      2166.1437     -178.33164    
       500   1892.5502     -876.06575      15796.489      14672.375      15077.762      16721.593     -8908.5291      2001.3175      853.81675    
       600   2020.9141     -874.61327      16529.028      17334.319      16918.785      17006.217     -8846.5461      2500.706      -3648.7574    
       700   1975.7728     -879.22945      16575.449      17266.745      15887.944      17064.273     -7553.1175      857.48483     -1155.9624    
       800   2037.1475     -872.09493      18784.149      14511.991      17037.746      17956.357     -6686.3753     -3456.045      -5769.4622    
       900   1825.4466     -876.12307      16488.288      17840.068      15241.848      17643.37      -14710.298      1817.0513     -2152.7875    
      1000   1816.8259     -877.736        16998.856      16943.251      16355.04       18933.904     -8112.5771      4799.1415     -2157.4887    
Loop time of 0.175772 on 8 procs for 1000 steps with 216 atoms

Performance: 491.547 ns/day, 0.049 hours/ns, 5689.203 timesteps/s, 1.229 Matom-step/s
99.7% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.096848   | 0.10562    | 0.11626    |   2.0 | 60.09
Neigh   | 0.0014204  | 0.0014864  | 0.001584   |   0.1 |  0.85
Comm    | 0.049767   | 0.060675   | 0.069357   |   2.6 | 34.52
Output  | 0.00031994 | 0.00034215 | 0.00045183 |   0.0 |  0.19
Modify  | 0.0031147  | 0.0031709  | 0.0033085  |   0.1 |  1.80
Other   |            | 0.00448    |            |       |  2.55

Nlocal:             27 ave          29 max          25 min
Histogram: 1 0 3 0 0 1 0 1 0 2
Nghost:          252.5 ave         254 max         250 min
Histogram: 1 0 1 0 0 2 0 1 0 3
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:          707 ave         784 max         651 min
Histogram: 1 2 1 0 1 1 0 0 1 1

Total # of neighbors = 5656
Ave neighs/atom = 26.185185
Neighbor list builds = 31
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# must undefine fix ave/time before resetting the timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential
pair_style	sw
pair_coeff * * Si.sw Si
Reading sw potential file Si.sw with DATE: 2007-06-11

# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:897)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 ${temp} ${tdamp} ${seed}
fix 5 all langevin 2000 2000 ${tdamp} ${seed}
fix 5 all langevin 2000 2000 0.01 ${seed}
fix 5 all langevin 2000 2000 0.01 123457


run ${nrun}
run 300
Per MPI rank memory allocation (min/avg/max) = 3.053 | 3.053 | 3.053 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   1816.8259     -877.736        16998.856      0              0              0              0              0              0            
       100   1974.4783     -873.49331      17541.611      17092.523      17526.339      18743.918     -8978.0392      1980.287      -4160.2443    
       200   2001.6451     -873.78552      17443.159      19757.663      17862.297      19079.323     -6161.6602      7098.7763     -3245.7314    
       300   2009.8887     -871.22387      18527.904      15384.447      16517.025      19401.094     -6593.4862     -1637.8844     -361.71628    
Loop time of 0.048308 on 8 procs for 300 steps with 216 atoms

Performance: 536.558 ns/day, 0.045 hours/ns, 6210.158 timesteps/s, 1.341 Matom-step/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.025969   | 0.031165   | 0.033177   |   1.3 | 64.51
Neigh   | 0.00039152 | 0.0004207  | 0.00043147 |   0.0 |  0.87
Comm    | 0.012436   | 0.014434   | 0.019675   |   1.9 | 29.88
Output  | 9.3973e-05 | 0.00010017 | 0.00013383 |   0.0 |  0.21
Modify  | 0.00088383 | 0.00092997 | 0.00094273 |   0.0 |  1.93
Other   |            | 0.001258   |            |       |  2.61

Nlocal:             27 ave          30 max          25 min
Histogram: 1 0 4 0 1 0 0 0 0 2
Nghost:            252 ave         255 max         248 min
Histogram: 1 1 0 0 0 2 0 2 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:        703.5 ave         787 max         647 min
Histogram: 2 0 2 2 0 0 0 0 0 2

Total # of neighbors = 5628
Ave neighs/atom = 26.055556
Neighbor list builds = 9
Dangerous builds = 0

# Obtain new stress tensor

variable tmp equal pe
variable e1 equal ${tmp}
variable e1 equal -871.223867233599
variable tmp equal press
variable p1 equal ${tmp}
variable p1 equal 18527.9043581702
variable tmp equal pxx
variable pxx1 equal ${tmp}
variable pxx1 equal 18099.2395662444
variable tmp equal pyy
variable pyy1 equal ${tmp}
variable pyy1 equal 19086.087999591
variable tmp equal pzz
variable pzz1 equal ${tmp}
variable pzz1 equal 18398.3855086752
variable tmp equal pxy
variable pxy1 equal ${tmp}
variable pxy1 equal -15996.0453395124
variable tmp equal pxz
variable pxz1 equal ${tmp}
variable pxz1 equal -2200.96189944233
variable tmp equal pyz
variable pyz1 equal ${tmp}
variable pyz1 equal 2830.50398530195

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -8.22097578847201
variable C2pos equal ${d2}
variable C2pos equal -13.529901902176
variable C3pos equal ${d3}
variable C3pos equal -0.924867121633997
variable C4pos equal ${d4}
variable C4pos equal -15.5436032143506
variable C5pos equal ${d5}
variable C5pos equal -3.202113728097
variable C6pos equal ${d6}
variable C6pos equal 86.0158798187191

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(0.804567412432007+${C1pos})
variable C16 equal 0.5*(0.804567412432007+-8.22097578847201)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-3.305607322743+${C2pos})
variable C26 equal 0.5*(-3.305607322743+-13.529901902176)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-8.64656039209351+${C3pos})
variable C36 equal 0.5*(-8.64656039209351+-0.924867121633997)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(11.9263984276047+${C4pos})
variable C46 equal 0.5*(11.9263984276047+-15.5436032143506)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(18.695011992496+${C5pos})
variable C56 equal 0.5*(18.695011992496+-3.202113728097)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(17.1133287609126+${C6pos})
variable C66 equal 0.5*(17.1133287609126+86.0158798187191)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 129.697186756901
variable C22all equal ${C22}
variable C22all equal 126.477173834183
variable C33all equal ${C33}
variable C33all equal 137.028000968916

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(73.6272296205219+${C21})
variable C12all equal 0.5*(73.6272296205219+76.9767207525319)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(71.233529235322+${C31})
variable C13all equal 0.5*(71.233529235322+80.1375919486686)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(86.298816509503+${C32})
variable C23all equal 0.5*(86.298816509503+90.4515760710918)

variable C44all equal ${C44}
variable C44all equal 16.9918137028559
variable C55all equal ${C55}
variable C55all equal 18.7509877283728
variable C66all equal ${C66}
variable C66all equal 51.5646042898158

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-3.84169303347149+${C41})
variable C14all equal 0.5*(-3.84169303347149+-1.79037360168435)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(3.93196169885175+${C51})
variable C15all equal 0.5*(3.93196169885175+-42.4714725635926)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-3.70820418802+${C61})
variable C16all equal 0.5*(-3.70820418802+-0.771332612377275)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(4.34247630811175+${C42})
variable C24all equal 0.5*(4.34247630811175+-12.1736712249212)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(3.35351088100475+${C52})
variable C25all equal 0.5*(3.35351088100475+3.3753716687571)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-8.4177546124595+${C62})
variable C26all equal 0.5*(-8.4177546124595+11.2016808066477)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(5.96973855950276+${C43})
variable C34all equal 0.5*(5.96973855950276+-0.1455864565665)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-2.73926965001874+${C53})
variable C35all equal 0.5*(-2.73926965001874+-24.6171380343247)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-4.78571375686375+${C63})
variable C36all equal 0.5*(-4.78571375686375+-31.7389289163425)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-32.8180042079748+${C54})
variable C45all equal 0.5*(-32.8180042079748+13.2960576860045)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.80860239337295+${C64})
variable C46all equal 0.5*(-1.80860239337295+-13.3045770341583)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(7.7464491321995+${C65})
variable C56all equal 0.5*(7.7464491321995+-3.98496212739325)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (129.697186756901+${C22all}+${C33all})/3.0
variable C11cubic equal (129.697186756901+126.477173834183+${C33all})/3.0
variable C11cubic equal (129.697186756901+126.477173834183+137.028000968916)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (75.3019751865269+${C13all}+${C23all})/3.0
variable C12cubic equal (75.3019751865269+75.6855605919953+${C23all})/3.0
variable C12cubic equal (75.3019751865269+75.6855605919953+88.3751962902974)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (16.9918137028559+${C55all}+${C66all})/3.0
variable C44cubic equal (16.9918137028559+18.7509877283728+${C66all})/3.0
variable C44cubic equal (16.9918137028559+18.7509877283728+51.5646042898158)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (131.067453853333+2*${C12cubic})/3.0
variable bulkmodulus equal (131.067453853333+2*79.7875773562732)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 29.1024685736815
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (131.067453853333-${C12cubic})/2.0
variable shearmodulus2 equal (131.067453853333-79.7875773562732)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+131.067453853333/${C12cubic})
variable poissonratio equal 1.0/(1.0+131.067453853333/79.7875773562732)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 129.697186756901 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 126.477173834183 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 137.028000968916 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 75.3019751865269 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 75.6855605919953 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 88.3751962902974 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 16.9918137028559 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 18.7509877283728 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 51.5646042898158 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = -2.81603331757792 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = -19.2697554323704 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -2.23976840019864 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -3.91559745840473 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = 3.36444127488092 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = 1.3919630970941 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 2.91207605146813 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = -13.6782038421717 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -18.2623213366031 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = -9.76097326098515 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = -7.55658971376563 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = 1.88074350240313 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 96.8808695219598 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 29.1024685736815 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 25.6399382485299 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.378400159097737
Total wall time: 0:00:03
