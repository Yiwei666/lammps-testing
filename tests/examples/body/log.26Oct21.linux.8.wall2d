LAMMPS (29 Sep 2021)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0.0000000 0.0000000 -0.50000000) to (12.000000 12.000000 0.50000000)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.001 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replicating atoms ...
  orthogonal box = (0.0000000 0.0000000 -0.50000000) to (48.000000 48.000000 0.50000000)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.001 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p
Changing box ...

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.377 | 5.377 | 5.377 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.51464289 0.00099012638   0.51563301  0.013444625 
    2000   0.55653313 0.0040982283   0.56063136 0.0034505512 
    3000   0.75323998  0.023578898   0.77681887 0.0036652891 
    4000   0.70044978  0.092406287   0.79285607 0.0089262842 
    5000   0.54548803  0.096501313   0.64198934 0.0051379522 
    6000   0.48208828  0.097798868   0.57988715   0.01529805 
    7000   0.68219182  0.038843949   0.72103577  0.016842202 
    8000   0.53792445   0.01298383   0.55090828 0.0066797984 
    9000   0.49980358  0.029397965   0.52920155 0.0046731992 
   10000   0.48705755   0.10138831   0.58844586 -1.9690664e-05 
   11000   0.52151879  0.065897951   0.58741674 0.0049324905 
   12000   0.59065198  0.039296831   0.62994881 0.0014198453 
   13000   0.46076898   0.07336394   0.53413292 0.0057849113 
   14000   0.38058173    0.1633735   0.54395523 0.0099915348 
   15000   0.58939916   0.13208605   0.72148521  0.012678595 
   16000   0.65384903   0.10746916   0.76131819   0.01547525 
   17000   0.52416619  0.079646027   0.60381222  0.011310563 
   18000   0.41773011  0.035521535   0.45325164  0.012969437 
   19000   0.57114481  0.038071167   0.60921598 0.0024550558 
   20000    0.6361157   0.11380808   0.74992378  0.012416422 
   21000   0.47111412   0.17859844   0.64971256  0.031765985 
   22000   0.55723812  0.058267695   0.61550582 -0.0014718863 
   23000   0.56562301   0.13636049    0.7019835  0.016749206 
   24000     0.501058   0.12287985   0.62393785  0.023726172 
   25000   0.68057383   0.25157577   0.93214959  0.060394761 
   26000   0.47593234   0.14180547   0.61773781  0.037920544 
   27000   0.66350086    0.1196084   0.78310926  0.017854396 
   28000   0.54733073   0.11967964   0.66701037 -6.4937635e-05 
   29000   0.55507975   0.13808291   0.69316266 -0.0011147247 
   30000   0.45238815   0.16914012   0.62152827  0.041670336 
   31000   0.36076234   0.16235716    0.5231195 0.0074104017 
   32000   0.44700042   0.10422518    0.5512256  0.025203725 
   33000   0.61537235   0.23306978   0.84844213  -0.02026102 
   34000   0.43643519    0.1564421   0.59287728  0.036125867 
   35000   0.70213071   0.12986017   0.83199088  0.011651191 
   36000   0.49903851   0.20176402   0.70080252  0.048891407 
   37000   0.38911383   0.24724187    0.6363557 -0.0050173569 
   38000   0.33885452   0.39965275   0.73850727  0.084365933 
   39000   0.35028187   0.17219036   0.52247223  0.011608381 
   40000   0.55889989   0.21402493   0.77292482  0.029453368 
   41000   0.36541986   0.23719373   0.60261359  0.034152498 
   42000   0.46349124   0.23328154   0.69677278  0.017491219 
   43000   0.52228865   0.28354003   0.80582869 -0.0085367458 
   44000   0.49994998   0.27393323   0.77388321  0.018448886 
   45000   0.43552805   0.21624635    0.6517744   0.04034225 
   46000   0.33107751    0.1646137   0.49569121  0.010448117 
   47000    0.5710989   0.41062199   0.98172089  0.039847888 
   48000   0.57919716   0.29642016   0.87561732 -0.0038197833 
   49000   0.52933621   0.39166217   0.92099838  0.084814085 
   50000   0.50045456   0.34516718   0.84562174  0.019269211 
   51000   0.63531481   0.17289081   0.80820562  0.044415138 
   52000    0.6124905   0.30194768   0.91443818  0.049284078 
   53000   0.60464872   0.29625118    0.9008999  0.047727067 
   54000   0.51422455     0.275646   0.78987055  0.060425027 
   55000   0.39057732   0.31485292   0.70543024  0.011142324 
   56000    0.6568485   0.31804592   0.97489442  0.075931878 
   57000   0.47550645   0.35049418   0.82600063 -0.00098497558 
   58000    0.4544041   0.24563865   0.70004275  0.020709663 
   59000   0.49997061   0.32586662   0.82583722 -0.029952046 
   60000   0.69656549   0.32974096    1.0263064  0.093535229 
   61000   0.57249393   0.43143844    1.0039324  0.016003027 
   62000   0.43873576   0.37495392   0.81368968  0.088455215 
   63000   0.57570672   0.40038266   0.97608938  0.066719638 
   64000   0.60561544   0.32531111   0.93092655  0.008389185 
   65000   0.43869523   0.34647215   0.78516737  0.062838273 
   66000   0.62650235   0.25697405    0.8834764  0.039502625 
   67000   0.46073666   0.39450232   0.85523898  0.036298979 
   68000   0.58627523   0.36886074   0.95513597   0.12124423 
   69000   0.60832058   0.49315067    1.1014712   0.14518127 
   70000    0.5627833   0.39704636   0.95982966  0.068757367 
   71000    0.5537765   0.34233003   0.89610653  0.034389939 
   72000   0.73010716   0.37072129    1.1008284  0.063562141 
   73000   0.79329552   0.24607601    1.0393715   0.12256938 
   74000   0.45465381   0.43646041   0.89111421  0.063684568 
   75000   0.42545973   0.47820457    0.9036643   0.17991282 
   76000   0.58498319   0.42589558    1.0108788  0.046191582 
   77000   0.60284892   0.50488092    1.1077298   0.10238518 
   78000   0.54809487   0.48282369    1.0309186   0.16767671 
   79000    0.6618092   0.49570348    1.1575127   0.15701486 
   80000   0.54176052   0.44157596   0.98333648   0.10030064 
   81000    0.6312697   0.36562312   0.99689282   0.22283199 
   82000   0.80123628   0.39868653    1.1999228    0.1605599 
   83000   0.72521785   0.35154041    1.0767583  0.035615532 
   84000   0.55943907   0.68907863    1.2485177   0.14820597 
   85000   0.62731842    0.6345626     1.261881  0.012595097 
   86000   0.57530425   0.49799665    1.0733009  0.093881553 
   87000   0.57311837   0.56778216    1.1409005   0.17173001 
   88000   0.51181422   0.53231515    1.0441294  0.059684673 
   89000   0.63037292    0.4580803    1.0884532   0.13916951 
   90000   0.55117107   0.67664023    1.2278113   0.13620196 
   91000   0.56719594   0.66474411    1.2319401   0.01250189 
   92000   0.61648144   0.62918199    1.2456634  0.025822924 
   93000   0.68390991   0.52953506     1.213445   0.14623026 
   94000   0.63466035   0.45907359    1.0937339 -0.0047502188 
   95000   0.61090711   0.57582566    1.1867328  0.052751296 
   96000   0.54033227   0.60415481    1.1444871   0.11581564 
   97000   0.66315855   0.92423417    1.5873927   0.12701714 
   98000   0.65606804   0.60586068    1.2619287  0.093332935 
   99000   0.57945555   0.77104211    1.3504977  -0.01833163 
  100000   0.50769247   0.60314723    1.1108397  0.026761296 
Loop time of 2.38194 on 8 procs for 100000 steps with 32 atoms

Performance: 3627292.370 tau/day, 41982.551 timesteps/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.16438    | 0.21798    | 0.25455    |   6.3 |  9.15
Neigh   | 0.0014813  | 0.0020934  | 0.0025396  |   0.8 |  0.09
Comm    | 0.68061    | 0.73751    | 0.81398    |   4.9 | 30.96
Output  | 0.0010772  | 0.0011919  | 0.0015331  |   0.4 |  0.05
Modify  | 1.1675     | 1.2105     | 1.2469     |   2.5 | 50.82
Other   |            | 0.2127     |            |       |  8.93

Nlocal:        4.00000 ave           6 max           2 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Nghost:        13.1250 ave          15 max          11 min
Histogram: 1 0 1 0 0 3 0 2 0 1
Neighs:        6.50000 ave           9 max           3 min
Histogram: 1 1 0 1 0 0 2 0 1 2

Total # of neighbors = 52
Ave neighs/atom = 1.6250000
Neighbor list builds = 3125
Dangerous builds = 0
Total wall time: 0:00:02
