LAMMPS (2 Aug 2023 - Development - bc02a7cc6)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.002 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replication is creating a 4x4x1 = 16 times larger system...
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.001 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p
Changing box ...

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.377 | 5.377 | 5.377 Mbytes
   Step         KinEng         PotEng         TotEng         Press     
         0   0.484375       0.25           0.734375       0.0067274306 
      1000   0.51123589     0.0015491224   0.51278502     0.01490608   
      2000   0.5574676      0.0040102995   0.5614779      0.0034546289 
      3000   0.75318378     0.023910669    0.77709445     0.0036741545 
      4000   0.70131716     0.09141577     0.79273293     0.0089596642 
      5000   0.50961063     0.041543988    0.55115462     0.0039730802 
      6000   0.50190631     0.0021567985   0.50406311     0.0027293183 
      7000   0.69899206     0.057390678    0.75638274     0.015738249  
      8000   0.53888415     0.015772447    0.55465659     0.0057182421 
      9000   0.5151378      0.01218174     0.52731954     0.0069028945 
     10000   0.43910035     0.049805059    0.48890541     0.00070891919
     11000   0.54736361     0.10271003     0.65007365     0.017220412  
     12000   0.68690801     0.092150164    0.77905817     0.0021321819 
     13000   0.57955766     0.08435101     0.66390867     0.015636098  
     14000   0.53720998     0.04435785     0.58156783     0.014585078  
     15000   0.70586634     0.040428868    0.74629521     0.002338876  
     16000   0.51333261     0.05085494     0.56418755     0.0027067287 
     17000   0.59153977     0.19338103     0.7849208      0.02534768   
     18000   0.45583359     0.15361669     0.60945028     0.014432306  
     19000   0.67515426     0.14101987     0.81617413    -0.0011717335 
     20000   0.57953328     0.090332953    0.66986623    -0.003952741  
     21000   0.39390024     0.20612292     0.60002317     0.039089837  
     22000   0.55577583     0.1187236      0.67449943     0.020493516  
     23000   0.56043291     0.07287192     0.63330483     0.0028817046 
     24000   0.58659558     0.098427342    0.68502293     0.024476994  
     25000   0.56286695     0.087006769    0.64987372     0.00022568912
     26000   0.45627946     0.27046347     0.72674292     0.092124013  
     27000   0.4883939      0.095279577    0.58367348    -0.0021583284 
     28000   0.53042394     0.15991224     0.69033618     0.023858927  
     29000   0.65482939     0.15446603     0.80929542    -0.0065900489 
     30000   0.39803165     0.17630602     0.57433767     0.057188696  
     31000   0.49259624     0.2107985      0.70339474     0.050913062  
     32000   0.54134932     0.17980705     0.72115637     0.01975197   
     33000   0.51992692     0.089031862    0.60895878     0.003411715  
     34000   0.40904768     0.22471244     0.63376012     0.023716807  
     35000   0.4069538      0.21080258     0.61775638     0.014368561  
     36000   0.26874105     0.12556058     0.39430163     0.0092528726 
     37000   0.39654644     0.20343392     0.59998037     0.082531861  
     38000   0.44391067     0.21696445     0.66087512     0.044894276  
     39000   0.43214296     0.23125138     0.66339434     0.058588076  
     40000   0.37830836     0.22513064     0.603439       0.0058046981 
     41000   0.41423501     0.30506262     0.71929764     0.082597331  
     42000   0.50571108     0.17704816     0.68275924     0.020740048  
     43000   0.58258693     0.20214018     0.7847271      0.015679739  
     44000   0.41703536     0.30085147     0.71788683     0.077369643  
     45000   0.49459936     0.1989458      0.69354516     0.026161612  
     46000   0.57376844     0.21175084     0.78551928     0.062429928  
     47000   0.40116678     0.2972302      0.69839698     0.06839928   
     48000   0.52135316     0.25541051     0.77676367     0.055283295  
     49000   0.41275415     0.23802875     0.6507829      0.070728418  
     50000   0.45925523     0.28114112     0.74039635     0.042653535  
     51000   0.485265       0.42343743     0.90870243    -0.030046171  
     52000   0.49932246     0.31610722     0.81542969     0.00051181071
     53000   0.4933327      0.30052749     0.79386019     0.015581645  
     54000   0.49319445     0.19386235     0.6870568     -0.0059651542 
     55000   0.48271087     0.35391561     0.83662648     0.047118815  
     56000   0.5304688      0.26597605     0.79644485     0.031763318  
     57000   0.54894766     0.16293717     0.71188483     0.11226951   
     58000   0.47573299     0.26680671     0.74253969     0.056944712  
     59000   0.47410811     0.23012621     0.70423431     0.077476222  
     60000   0.62636947     0.38265786     1.0090273      0.068930309  
     61000   0.62839455     0.38218301     1.0105776      0.073933976  
     62000   0.54360065     0.26161697     0.80521762     0.087750621  
     63000   0.3327864      0.56183255     0.89461895     0.082279629  
     64000   0.4643157      0.42601707     0.89033278     0.032533694  
     65000   0.41802473     0.3319857      0.75001043     0.041617753  
     66000   0.59243494     0.31304374     0.90547868    -0.027373332  
     67000   0.50261873     0.28082019     0.78343892     0.01280059   
     68000   0.70374208     0.47728055     1.1810226      0.064192805  
     69000   0.48797475     0.5359071      1.0238818      0.16875736   
     70000   0.38817464     0.44013547     0.8283101      0.099626404  
     71000   0.29865317     0.32959366     0.62824683     0.023127243  
     72000   0.41391521     0.41507675     0.82899197     0.0091312671 
     73000   0.43678099     0.4228658      0.85964679     0.072734116  
     74000   0.39522223     0.34909814     0.74432036     0.043766909  
     75000   0.39405394     0.2544683      0.64852224     0.076382757  
     76000   0.4706816      0.38263633     0.85331793     0.11308832   
     77000   0.54211961     0.27111732     0.81323693     0.01377614   
     78000   0.49021906     0.28101079     0.77122985     0.072237683  
     79000   0.45512119     0.34945539     0.80457658     0.0010238676 
     80000   0.60157575     0.37940709     0.98098284     0.051668626  
     81000   0.67189739     0.28354614     0.95544352     0.16125699   
     82000   0.4199041      0.32896998     0.74887408     0.018500811  
     83000   0.46317102     0.2652458      0.72841682     0.078115625  
     84000   0.47739396     0.51137845     0.98877242     0.04954433   
     85000   0.44908147     0.28534621     0.73442768     0.073497526  
     86000   0.39197651     0.36414443     0.75612094     0.019724901  
     87000   0.46555007     0.39470062     0.8602507      0.061791606  
     88000   0.42698233     0.4178298      0.84481213     0.061547406  
     89000   0.38299201     0.39121113     0.77420315     0.12947587   
     90000   0.72068476     0.41936986     1.1400546      0.00024388412
     91000   0.67535528     0.44115447     1.1165098      0.15501976   
     92000   0.40489336     0.40299119     0.80788455     0.028136575  
     93000   0.3668083      0.52351064     0.89031893     0.075382461  
     94000   0.49805381     0.60971303     1.1077668      0.10605515   
     95000   0.5337491      0.5024138      1.0361629      0.069561892  
     96000   0.4760048      0.5727611      1.0487659      0.15137186   
     97000   0.42246274     0.48587567     0.90833841     0.012202217  
     98000   0.4041574      0.44419922     0.84835662     0.001747889  
     99000   0.46648165     0.42069224     0.88717388     0.044474642  
    100000   0.46748746     0.57698687     1.0444743      0.051896709  
Loop time of 5.27938 on 8 procs for 100000 steps with 32 atoms

Performance: 1636555.504 tau/day, 18941.615 timesteps/s, 606.132 katom-step/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.37356    | 0.43288    | 0.6223     |  12.5 |  8.20
Neigh   | 0.0066139  | 0.0071731  | 0.0080755  |   0.6 |  0.14
Comm    | 1.4903     | 1.7129     | 1.8458     |   9.4 | 32.45
Output  | 0.0038816  | 0.0042279  | 0.006289   |   1.2 |  0.08
Modify  | 2.5356     | 2.6319     | 2.7484     |   4.1 | 49.85
Other   |            | 0.4903     |            |       |  9.29

Nlocal:              4 ave           5 max           3 min
Histogram: 2 0 0 0 0 4 0 0 0 2
Nghost:          12.25 ave          13 max          10 min
Histogram: 1 0 0 0 0 0 3 0 0 4
Neighs:            5.5 ave           7 max           2 min
Histogram: 1 0 0 0 0 0 3 0 1 3

Total # of neighbors = 44
Ave neighs/atom = 1.375
Neighbor list builds = 3253
Dangerous builds = 0
Total wall time: 0:00:05
