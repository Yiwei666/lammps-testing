LAMMPS (29 Sep 2021)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0.0000000 0.0000000 -0.50000000) to (12.000000 12.000000 0.50000000)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.001 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replicating atoms ...
  orthogonal box = (0.0000000 0.0000000 -0.50000000) to (48.000000 48.000000 0.50000000)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.001 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.378 | 5.378 | 5.378 Mbytes
Step KinEng PotEng TotEng Press 
       0     0.484375         0.25     0.734375 0.0067274306 
    1000   0.39720235 0.0015845731   0.39878692   0.00223489 
    2000   0.42893425  0.011718891   0.44065314 0.0027413224 
    3000   0.57823511  0.012407489    0.5906426 0.0025306081 
    4000   0.71610647  0.028149437   0.74425591 0.0016504948 
    5000   0.84027279  0.018917017    0.8591898 0.0037451875 
    6000   0.72410001  0.073495378   0.79759539 0.00018672845 
    7000   0.53886484  0.077723366   0.61658821 0.0047292158 
    8000   0.66196054  0.055022422   0.71698296 0.0054997391 
    9000   0.93104064  0.071628784    1.0026694  0.011330625 
   10000   0.75494387   0.15204113   0.90698499   0.02170256 
   11000   0.72349198   0.11102334   0.83451533  0.019265741 
   12000   0.56216761    0.1170581   0.67922571 -0.028309134 
   13000   0.63812147   0.11688482   0.75500629  0.029237154 
   14000   0.63674855  0.042118786   0.67886733  0.019685482 
   15000   0.65288886  0.017100534   0.66998939 -0.014193319 
   16000   0.70115328  0.034993361   0.73614664  0.011000384 
   17000   0.73008886  0.049920427   0.78000929  0.018690073 
   18000   0.61254777  0.060519597   0.67306737  0.013068649 
   19000   0.41674848  0.037863347   0.45461183  0.011317926 
   20000   0.49762537  0.096750706   0.59437607  0.020425786 
   21000   0.70923512     0.102227   0.81146211   0.02308138 
   22000    0.5606094   0.24393856   0.80454796     0.053159 
   23000   0.48794925   0.26301563   0.75096489  0.045890982 
   24000   0.44060334   0.25439712   0.69500046  0.022476954 
   25000   0.54113298   0.11773159   0.65886457  0.022056808 
   26000    0.7014898 1.7170805e-05   0.70150697 0.0035684167 
   27000    0.7883595  0.080886924   0.86924643  0.020722123 
   28000   0.67172436  0.047908041    0.7196324  0.032392681 
   29000   0.63352756   0.04710589   0.68063346  0.020371034 
   30000   0.44327505   0.20865204   0.65192708  0.060872037 
   31000   0.45970651   0.12148741   0.58119391  0.037665583 
   32000   0.61631317  0.058569987   0.67488316  0.026359917 
   33000   0.70494701   0.14787751   0.85282451  0.032214598 
   34000   0.35651598   0.26267551   0.61919149 0.0015921456 
   35000   0.27757405   0.12517437   0.40274842 0.0077297907 
   36000   0.39800805   0.16550304   0.56351109  0.049355675 
   37000   0.58293658   0.16494825   0.74788483  0.023365787 
   38000   0.49479973   0.18772586   0.68252559  0.010824322 
   39000   0.44483402   0.12084398     0.565678  0.030932162 
   40000   0.63690682   0.11567973   0.75258654  0.010061394 
   41000   0.17555966   0.14975746   0.32531712   0.03191113 
   42000   0.17332081   0.22568254   0.39900335  0.021820193 
   43000   0.24551983   0.17912365   0.42464347   0.02722384 
   44000   0.28996792   0.24474991   0.53471784  0.055832933 
   45000   0.33883311   0.22803728   0.56687039  0.045434102 
   46000   0.14046584    0.0934797   0.23394554  0.030109763 
   47000  0.099482482   0.14496996   0.24445244  0.030941495 
   48000   0.10041858    0.1656902   0.26610878    0.0573676 
   49000   0.16448996   0.21683588   0.38132584  0.042628168 
   50000   0.17339485   0.14670757   0.32010242  0.055181484 
   51000   0.17195658   0.29255901    0.4645156 0.0030258851 
   52000   0.19020297   0.13522429   0.32542726  0.028730044 
   53000   0.48557654    0.1434669   0.62904344  0.039129992 
   54000   0.97887559   0.13253727    1.1114129  0.076078329 
   55000   0.96239487  0.077613103     1.040008  0.059639835 
   56000   0.59441604 -0.0069672587   0.58744878  0.070750914 
   57000   0.52412714 -0.035045129   0.48908201  0.044738985 
   58000   0.75523902 -0.031345614   0.72389341  0.060400541 
   59000   0.96937551 -0.035012938   0.93436257  0.056471026 
   60000   0.73913791 -0.039322631   0.69981528  0.060083461 
   61000   0.56854683  -0.03931007   0.52923676  0.062595665 
   62000   0.65406252 -0.035912544   0.61814998   0.05875211 
   63000   0.88056034 -0.038295821   0.84226452  0.061519778 
   64000   0.84204914 -0.042303045   0.79974609  0.063803952 
   65000    0.6355828 -0.019979297    0.6156035  0.066344472 
   66000   0.61552047 0.0012944071   0.61681488   0.06835581 
   67000    0.7735926 -0.0026351532   0.77095745  0.076179182 
   68000   0.87873046  0.039624359   0.91835482  0.073075202 
   69000   0.72350023    0.0970286   0.82052883  0.063144943 
   70000   0.61107841  0.033240137   0.64431855  0.064639705 
   71000   0.68747142  -0.01982489   0.66764653  0.073494735 
   72000   0.85618783 -0.024061008   0.83212682  0.063351705 
   73000   0.80004467 -0.022987187   0.77705748   0.06921435 
   74000   0.62992915 -0.027523803   0.60240535  0.074773232 
   75000   0.64137189 -0.024392623   0.61697926  0.075792213 
   76000   0.87839758 -0.026854224   0.85154336  0.075064127 
   77000   0.86814573 -0.029900214   0.83824552  0.075495829 
   78000   0.74393762 -0.028132908   0.71580471  0.077566813 
   79000   0.71403976 -0.023917084   0.69012268  0.078880868 
   80000   0.72487616   -0.0218251   0.70305106  0.079542992 
   81000   0.78649505 -0.023431099   0.76306395  0.080185981 
   82000   0.83649423  -0.02561379   0.81088044  0.081147028 
   83000   0.68665231 -0.024986651   0.66166565  0.082481839 
   84000   0.58963873 -0.020595369   0.56904336  0.083636698 
   85000   0.74818522 -0.016432053   0.73175317  0.082270038 
   86000   0.90663784 -0.019335021   0.88730282  0.081105029 
   87000    0.7775063 -0.021881216   0.75562508  0.084974999 
   88000   0.70258528 -0.019635139   0.68295014  0.089012142 
   89000   0.70711414 -0.015737131     0.691377  0.089889637 
   90000   0.81108567 -0.015719129   0.79536654  0.089915284 
   91000   0.99252991 -0.019842983   0.97268693  0.089642017 
   92000   0.71777182 -0.020871966   0.69689985  0.090723076 
   93000   0.62660273 -0.015336653   0.61126608  0.092214407 
   94000   0.73064761 -0.010542092   0.72010552  0.093119924 
   95000   0.85227512 -0.014643427   0.83763169  0.094020203 
   96000   0.71119968 -0.018188088   0.69301159  0.095358406 
   97000   0.51112332 -0.013152331   0.49797099  0.096613709 
   98000   0.63360922 -0.0059928014   0.62761641  0.097430071 
   99000   0.77275385 -0.0097058627   0.76304799  0.098161844 
  100000    0.7841219 -0.015821019   0.76830088  0.099142278 
Loop time of 2.66895 on 8 procs for 100000 steps with 32 atoms

Performance: 3237229.697 tau/day, 37467.936 timesteps/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30653    | 0.45995    | 0.61834    |  17.4 | 17.23
Neigh   | 0.00078279 | 0.0009736  | 0.0012301  |   0.0 |  0.04
Comm    | 0.8573     | 1.0094     | 1.1496     |  11.4 | 37.82
Output  | 0.0010568  | 0.0011631  | 0.0015413  |   0.4 |  0.04
Modify  | 0.9655     | 0.98633    | 1.0044     |   1.4 | 36.96
Other   |            | 0.2112     |            |       |  7.91

Nlocal:        4.00000 ave           5 max           2 min
Histogram: 1 0 0 1 0 0 3 0 0 3
Nghost:        12.7500 ave          16 max          11 min
Histogram: 2 0 2 0 2 0 1 0 0 1
Neighs:        6.37500 ave           9 max           3 min
Histogram: 1 1 0 0 0 2 1 0 2 1

Total # of neighbors = 51
Ave neighs/atom = 1.5937500
Neighbor list builds = 1370
Dangerous builds = 0
Total wall time: 0:00:02
