LAMMPS (2 Aug 2023 - Development - bc02a7cc6)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.002 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replication is creating a 4x4x1 = 16 times larger system...
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.002 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.378 | 5.378 | 5.378 Mbytes
   Step         KinEng         PotEng         TotEng         Press     
         0   0.484375       0.25           0.734375       0.0067274306 
      1000   0.3969468      0.0015186136   0.39846541     0.0022308526 
      2000   0.4290668      0.011745913    0.44081271     0.0021024799 
      3000   0.58095943     0.01124691     0.59220634     0.0022902265 
      4000   0.74289678     0.02833452     0.7712313      0.0042292399 
      5000   0.8428552      0.014731736    0.85758694     0.0063886523 
      6000   0.72787017     0.039707388    0.76757756     0.0036077988 
      7000   0.55175505     0.12610708     0.67786212     0.0053330031 
      8000   0.62268713     0.075451492    0.69813862     0.011889057  
      9000   0.86853851     0.077819626    0.94635814     0.0091853235 
     10000   0.70325848     0.076941449    0.78019993    -0.017990068  
     11000   0.65420992     0.018651968    0.67286188     0.010901463  
     12000   0.71936201     0.033467179    0.75282919     0.014052713  
     13000   0.66467866     0.093724865    0.75840353     0.016959062  
     14000   0.64459129     0.037668193    0.68225948     0.0035048187 
     15000   0.49939485     0.23188568     0.73128053     0.022661304  
     16000   0.53373982     0.052254954    0.58599478     0.022662709  
     17000   0.65513669     0.081826049    0.73696274     0.016953432  
     18000   0.60391324     0.095143369    0.69905661     0.03028331   
     19000   0.6589036      0.11192204     0.77082564     0.025033851  
     20000   0.62101679     0.10640346     0.72742026     0.019639422  
     21000   0.67537971     0.054972593    0.73035231     0.017475055  
     22000   0.68819335     0.2441833      0.93237665     0.02611103   
     23000   0.53086655     0.13253986     0.66340641     0.032260843  
     24000   0.66485722     0.16946977     0.83432699     0.024609203  
     25000   0.7687534      0.16738578     0.93613918     0.031186871  
     26000   0.43010043     0.27991755     0.71001798     0.0092216733 
     27000   0.46420653     0.1011107      0.56531723     0.029499719  
     28000   0.58757093     0.057140824    0.64471176     0.030704393  
     29000   0.73707566     0.10897773     0.84605339     0.025809672  
     30000   0.62546105     0.10856498     0.73402603     0.0073492192 
     31000   0.26102409     0.35270151     0.61372559     0.086047624  
     32000   0.293151       0.09276309     0.38591409     0.018231932  
     33000   0.32339845     0.099742153    0.4231406      0.038943329  
     34000   0.46705584     0.10651126     0.5735671      0.033198672  
     35000   0.27178161     0.14498488     0.41676649     0.064147227  
     36000   0.36191761     0.039867184    0.40178479    -0.042164893  
     37000   0.58804265     0.14091024     0.72895289     0.071025375  
     38000   0.86954709     0.039907679    0.90945477     0.017199864  
     39000   0.41838797     0.40648387     0.82487184     0.018013412  
     40000   0.46276496     0.29673734     0.7595023      0.041599899  
     41000   0.46998025     0.19136133     0.66134158     0.077003158  
     42000   0.43625435     0.043617563    0.47987191     0.036191339  
     43000   0.38105112     0.093915643    0.47496676     0.060396825  
     44000   0.47394141     0.033924908    0.50786632     0.038172927  
     45000   0.66322303     0.023340984    0.68656402     0.036234094  
     46000   0.82504956     0.049312251    0.87436181     0.054252621  
     47000   0.9196084     -0.014825044    0.90478336     0.044499637  
     48000   0.43328102     0.12801185     0.56129287    -0.048847464  
     49000   0.38808469     0.063470536    0.45155523     0.068369283  
     50000   0.47657583     0.25093054     0.72750638     0.1013942    
     51000   0.50583528     0.22097729     0.72681257     0.039148276  
     52000   0.71583702     0.18717042     0.90300745     0.049611206  
     53000   0.59976922     0.2072974      0.80706662     0.051798085  
     54000   0.6422135      0.13627925     0.77849275     0.0071535601 
     55000   0.8328394      0.0058644446   0.83870385     0.0050577916 
     56000   0.85865885    -0.045920812    0.81273804     0.045468785  
     57000   0.6595449      0.031079294    0.6906242      0.045802321  
     58000   0.61228007     0.060445374    0.67272544     0.076975935  
     59000   0.76203289    -0.045632483    0.7164004      0.041113527  
     60000   0.87477649    -0.054770843    0.82000565     0.035809563  
     61000   0.70449311    -0.055197647    0.64929546     0.089125072  
     62000   0.54936252    -0.053406228    0.49595629     0.023526956  
     63000   0.62116509    -0.052996676    0.56816841     0.10232655   
     64000   0.72281962    -0.053389807    0.66942981     0.043760281  
     65000   0.82253347    -0.053576603    0.76895686     0.033222459  
     66000   0.75963473    -0.053543792    0.70609094     0.11651397   
     67000   0.59309279    -0.05254208     0.54055071     0.037300665  
     68000   0.6172665     -0.051175916    0.56609058     0.061074148  
     69000   0.92066731    -0.051710771    0.86895654     0.10069214   
     70000   0.81820674    -0.052563982    0.76564275     0.022684298  
     71000   0.67188723    -0.051692977    0.62019425     0.11143125   
     72000   0.67434041    -0.050310852    0.62402956     0.047671636  
     73000   0.84393924    -0.050103713    0.79383553     0.067108796  
     74000   1.0479063     -0.051471139    0.9964352      0.099139166  
     75000   0.66695341    -0.051396293    0.61555712     0.030507954  
     76000   0.63501443    -0.049088713    0.58592572     0.11678351   
     77000   0.77809431    -0.048169571    0.72992474     0.053524667  
     78000   0.85866981    -0.049126169    0.80954365     0.078504933  
     79000   0.66967709    -0.048878838    0.62079825     0.097735463  
     80000   0.55770268    -0.04665127     0.51105141     0.040254676  
     81000   0.68879834    -0.045765696    0.64303264     0.11555733   
     82000   0.75459497    -0.046462749    0.70813223     0.059573719  
     83000   0.74482354    -0.030841826    0.71398172     0.082834482  
     84000   0.70761865     0.0010366235   0.70865528     0.10089239   
     85000   0.69076777     0.0019145145   0.69268228     0.050894183  
     86000   0.77467168     0.033516145    0.80818783     0.12353482   
     87000   0.87326039     0.033077657    0.90633804     0.053526225  
     88000   0.70187307     0.033251838    0.7351249      0.10818017   
     89000   0.58064761     0.03558131     0.61622892     0.084880982  
     90000   0.70664033     0.037147237    0.74378757     0.05645689   
     91000   0.82970629     0.040059848    0.86976614     0.12085897   
     92000   0.76933527     0.042357232    0.8116925      0.065310695  
     93000   0.69275645     0.042604701    0.73536115     0.10793489   
     94000   0.68312643     0.041915441    0.72504187     0.12032685   
     95000   0.85701773     0.040521701    0.89753943     0.051490117  
     96000   0.93787563     0.038590202    0.97646583     0.12047546   
     97000   0.66001967     0.039293692    0.69931336     0.11429308   
     98000   0.64777968     0.040578814    0.6883585      0.054685109  
     99000   0.75933395     0.039102459    0.79843641     0.087601953  
    100000   0.82433749     0.128509       0.9528465      0.13651353   
Loop time of 6.10928 on 8 procs for 100000 steps with 32 atoms

Performance: 1414241.541 tau/day, 16368.536 timesteps/s, 523.793 katom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.86451    | 1.0773     | 1.3421     |  14.7 | 17.63
Neigh   | 0.0033203  | 0.0040078  | 0.0044638  |   0.6 |  0.07
Comm    | 2.2581     | 2.4786     | 2.6884     |   9.8 | 40.57
Output  | 0.0037553  | 0.0041617  | 0.006509   |   1.4 |  0.07
Modify  | 2.0067     | 2.0804     | 2.1634     |   4.1 | 34.05
Other   |            | 0.4648     |            |       |  7.61

Nlocal:              4 ave           5 max           2 min
Histogram: 1 0 0 1 0 0 3 0 0 3
Nghost:         15.375 ave          18 max          13 min
Histogram: 1 0 2 0 1 0 2 0 1 1
Neighs:          7.625 ave          12 max           2 min
Histogram: 1 0 0 0 1 3 0 1 0 2

Total # of neighbors = 61
Ave neighs/atom = 1.90625
Neighbor list builds = 1434
Dangerous builds = 0
Total wall time: 0:00:06
