LAMMPS (28 Mar 2023 - Development)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.002 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replication is creating a 4x4x1 = 16 times larger system...
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.002 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

change_box  all boundary p f p
Changing box ...

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 0.1
variable c_t        equal 0.1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 0.1 0.1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0 fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0 fixedpoint 0 0 0

fix          2 all enforce2d
fix          3 all wall/body/polygon 2000 50 50 yplane 0.0 48.0

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.377 | 5.377 | 5.377 Mbytes
   Step         KinEng         PotEng         TotEng         Press     
         0   0.484375       0.25           0.734375       0.0067274306 
      1000   0.51123589     0.0015491224   0.51278502     0.01490608   
      2000   0.5574676      0.0040102995   0.5614779      0.0034546289 
      3000   0.75318378     0.023910669    0.77709445     0.0036741545 
      4000   0.70131716     0.09141577     0.79273293     0.0089596642 
      5000   0.50961063     0.041543988    0.55115462     0.0039730802 
      6000   0.50190632     0.0021567974   0.50406311     0.0027293186 
      7000   0.69899208     0.057390634    0.75638272     0.015738247  
      8000   0.53888449     0.015773611    0.5546581      0.0057196029 
      9000   0.51515249     0.012192053    0.52734454     0.006913796  
     10000   0.43906968     0.049762769    0.48883245     0.00069664236
     11000   0.54683898     0.10448465     0.65132363     0.017379749  
     12000   0.68279289     0.097072731    0.77986562     0.0023916029 
     13000   0.57917972     0.06888595     0.64806567     0.014059408  
     14000   0.57171435     0.11445477     0.68616912     0.013544582  
     15000   0.60923567     0.096123779    0.70535945     0.005200408  
     16000   0.40467799     0.10214362     0.50682161     0.0053957453 
     17000   0.40992462     0.16778868     0.5777133      0.0025830373 
     18000   0.51861842     0.035807975    0.5544264      0.0011341971 
     19000   0.46942443     0.026993546    0.49641798    -0.0029823279 
     20000   0.42354437     0.040108401    0.46365278     0.004902955  
     21000   0.47224989     0.048046785    0.52029667     0.0039587694 
     22000   0.51848959     0.02036275     0.53885234     0.0042379179 
     23000   0.44107205     0.14128606     0.58235811     0.0080572893 
     24000   0.46710543     0.099564424    0.56666985     0.0065235214 
     25000   0.52384096     0.10260356     0.62644452     0.0004558188 
     26000   0.58252487     0.15254361     0.73506848     0.041509256  
     27000   0.50622142     0.089444389    0.5956658      0.0066991691 
     28000   0.49239638     0.17078917     0.66318554     0.018909845  
     29000   0.43006114     0.15847283     0.58853397     0.020118149  
     30000   0.50021772     0.17677074     0.67698846     0.015427475  
     31000   0.37956441     0.1557124      0.53527681    -0.0095805135 
     32000   0.37436392     0.18555898     0.5599229      0.058341213  
     33000   0.34521438     0.14227808     0.48749246     0.031911003  
     34000   0.41085744     0.19843844     0.60929588     0.016050886  
     35000   0.36499627     0.19374664     0.55874291     0.028762947  
     36000   0.45461278     0.14519354     0.59980632     0.0076326392 
     37000   0.35334966     0.11499371     0.46834337    -0.010810254  
     38000   0.39133616     0.1693786      0.56071477     0.0016581329 
     39000   0.39238108     0.21282232     0.6052034      0.037028689  
     40000   0.57040278     0.18975161     0.76015439     0.029565915  
     41000   0.60688442     0.21029705     0.81718147     0.013590687  
     42000   0.54378392     0.15606214     0.69984606     0.013078987  
     43000   0.69330491     0.16737157     0.86067648     0.027225252  
     44000   0.6611443      0.13377776     0.79492206     0.02417458   
     45000   0.65085558     0.22330763     0.87416321     0.01344045   
     46000   0.47357542     0.2369961      0.71057152     0.014186445  
     47000   0.58626633     0.22265456     0.80892089     0.0024449832 
     48000   0.79895407     0.26658942     1.0655435      0.13112923   
     49000   0.41118136     0.24448566     0.65566702     0.030599919  
     50000   0.61797796     0.37833103     0.99630899     0.080928086  
     51000   0.5146428      0.27268926     0.78733206     0.059543159  
     52000   0.52664476     0.2909604      0.81760516     0.010256706  
     53000   0.58510568     0.39197171     0.97707738     0.17579888   
     54000   0.63229682     0.23498895     0.86728577     0.019519553  
     55000   0.57263965     0.19648316     0.76912281    -0.005986731  
     56000   0.60157019     0.41451282     1.016083       0.12803893   
     57000   0.709478       0.50538598     1.214864      -0.022093041  
     58000   0.59610644     0.36567116     0.9617776      0.045296139  
     59000   0.53317044     0.42783072     0.96100116     0.0049505114 
     60000   0.52765168     0.40487096     0.93252264     0.046394219  
     61000   0.66852754     0.37762589     1.0461534     -0.015342126  
     62000   0.60598816     0.3134956      0.91948376     0.093341687  
     63000   0.58123619     0.30348103     0.88471722    -0.0073474815 
     64000   0.61775001     0.28712424     0.90487425     0.12488962   
     65000   0.54887336     0.45622203     1.0050954      0.092841361  
     66000   0.52392241     0.30073326     0.82465567     0.059973991  
     67000   0.56444811     0.289378       0.85382611     0.052473417  
     68000   0.64863604     0.46176636     1.1104024      0.013781886  
     69000   0.57394434     0.33765592     0.91160026     0.028872343  
     70000   0.61468097     0.32742164     0.94210261     0.059657364  
     71000   0.60087021     0.50128531     1.1021555      0.047263411  
     72000   0.55351851     0.5461945      1.099713       0.041335415  
     73000   0.63385448     0.45941879     1.0932733     -0.018416949  
     74000   0.52612585     0.40959859     0.93572444    -0.017352086  
     75000   0.6229927      0.57711714     1.2001098      0.034091156  
     76000   0.63790881     0.45688944     1.0947983      0.015426588  
     77000   0.58194761     0.49145523     1.0734028     -0.021476381  
     78000   0.54551096     0.36682692     0.91233788     0.049373329  
     79000   0.76103906     0.54278767     1.3038267      0.018225939  
     80000   0.70887064     0.55907909     1.2679497     -0.039900703  
     81000   0.56202666     0.4763527      1.0383794      0.071300652  
     82000   0.68746119     0.80885689     1.4963181      0.11226958   
     83000   0.52295529     0.59597987     1.1189352      0.017247183  
     84000   0.85227794     0.69042721     1.5427052      0.032605523  
     85000   0.78640548     0.61126893     1.3976744      0.053033816  
     86000   0.63231927     0.68595002     1.3182693      0.1030765    
     87000   0.43832707     0.58931393     1.027641       0.066223206  
     88000   0.61810744     0.67604802     1.2941555     -0.035401684  
     89000   0.63492114     0.65461951     1.2895406     -0.0099167789 
     90000   0.70855282     0.48555983     1.1941127     -0.053629979  
     91000   0.57818853     0.65512189     1.2333104      0.027930324  
     92000   0.94082835     0.72534246     1.6661708      0.059482931  
     93000   0.77460043     0.59769253     1.372293       0.051760273  
     94000   0.61254312     0.58431556     1.1968587     -0.022167059  
     95000   0.6333029      0.72161696     1.3549199      0.054031653  
     96000   0.47773123     0.71804052     1.1957718     -0.025671111  
     97000   0.65649871     0.7473553      1.403854       0.036817021  
     98000   0.69422691     0.78121936     1.4754463      0.16642025   
     99000   0.61873074     0.76702103     1.3857518      0.11956918   
    100000   0.5657553      1.0208287      1.586584       0.25575725   
Loop time of 3.80562 on 8 procs for 100000 steps with 32 atoms

Performance: 2270329.292 tau/day, 26276.959 timesteps/s, 840.863 katom-step/s
99.9% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28259    | 0.34171    | 0.3973     |   6.0 |  8.98
Neigh   | 0.0030282  | 0.0032437  | 0.0038232  |   0.4 |  0.09
Comm    | 1.0754     | 1.1522     | 1.2277     |   5.2 | 30.28
Output  | 0.0024807  | 0.0026741  | 0.0036687  |   0.7 |  0.07
Modify  | 1.879      | 1.9449     | 2.0026     |   3.1 | 51.11
Other   |            | 0.3609     |            |       |  9.48

Nlocal:              4 ave           5 max           3 min
Histogram: 3 0 0 0 0 2 0 0 0 3
Nghost:          13.75 ave          16 max          13 min
Histogram: 4 0 0 3 0 0 0 0 0 1
Neighs:              8 ave          11 max           4 min
Histogram: 1 1 1 0 0 1 0 1 1 2

Total # of neighbors = 64
Ave neighs/atom = 2
Neighbor list builds = 2938
Dangerous builds = 0
Total wall time: 0:00:03
