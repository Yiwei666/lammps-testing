LAMMPS (28 Mar 2023 - Development)
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  4 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.001 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replication is creating a 4x4x1 = 16 times larger system...
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  4 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.001 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.378 | 5.378 | 5.378 Mbytes
   Step         KinEng         PotEng         TotEng         Press     
         0   0.484375       0.25           0.734375       0.0067274306 
      1000   0.3969468      0.0015186136   0.39846541     0.0022308526 
      2000   0.4290668      0.011745913    0.44081271     0.0021024799 
      3000   0.58095943     0.01124691     0.59220634     0.0022902265 
      4000   0.74289678     0.02833452     0.7712313      0.0042292399 
      5000   0.8428552      0.014731736    0.85758694     0.0063886523 
      6000   0.72787017     0.039707388    0.76757756     0.0036077988 
      7000   0.55175505     0.12610707     0.67786212     0.0053330024 
      8000   0.62268717     0.07545127     0.69813844     0.011888643  
      9000   0.86853846     0.077819383    0.94635785     0.009185362  
     10000   0.70325755     0.076941057    0.78019861    -0.01798902   
     11000   0.65464858     0.018150102    0.67279869     0.0083358803 
     12000   0.72058567     0.032587401    0.75317307     0.013609312  
     13000   0.6647182      0.090613429    0.75533163     0.017050469  
     14000   0.63604869     0.044542387    0.68059108     0.01422169   
     15000   0.51476086     0.21432555     0.72908641     0.022455627  
     16000   0.51587023     0.03451384     0.55038407    -0.0053739127 
     17000   0.62780418     0.032385228    0.66018941     0.019255677  
     18000   0.6712768      0.056458292    0.72773509     0.011123638  
     19000   0.70293658     0.15601821     0.8589548      0.010887664  
     20000   0.59766995     0.17501257     0.77268252     0.014857972  
     21000   0.58584167     0.10471424     0.69055591     0.02679731   
     22000   0.49108091     0.20618626     0.69726717     0.013200916  
     23000   0.62898088     0.18708206     0.81606294     0.038159863  
     24000   0.74124553     0.20736727     0.94861281     0.0055525402 
     25000   0.64509367     0.078996484    0.72409016     0.022341494  
     26000   0.40454571     0.11583671     0.52038242     0.024541999  
     27000   0.53677449     0.14704169     0.68381618     0.022510494  
     28000   0.6234453      0.082163634    0.70560893     0.025226793  
     29000   0.35197068     0.19494044     0.54691113     0.017596145  
     30000   0.36776684     0.20640752     0.57417436     0.013225059  
     31000   0.49142863     0.21451438     0.70594301     0.023349579  
     32000   0.36540782     0.1597338      0.52514161     0.0063146301 
     33000   0.33290052     0.26733681     0.60023733    -0.0039876658 
     34000   0.46615178     0.14215629     0.60830808     0.040678258  
     35000   0.61071522     0.16123063     0.77194586     0.042077811  
     36000   0.70934666     0.18548879     0.89483545     0.031623996  
     37000   0.57434703     0.241016       0.81536303     0.044906026  
     38000   0.73204766     0.13353919     0.86558685     0.054091658  
     39000   0.65793067     0.15850975     0.81644042     0.044896113  
     40000   0.62747726     0.15071964     0.7781969      0.021473993  
     41000   0.67368514     0.10237592     0.77606106     0.040493151  
     42000   0.60166092     0.10957435     0.71123526     0.044692743  
     43000   0.6040278      0.099345757    0.70337356     0.041922717  
     44000   0.61342276     0.12359565     0.73701842     0.034503706  
     45000   0.6359215      0.12982397     0.76574547     0.045490463  
     46000   0.64314534     0.10931832     0.75246366     0.068286861  
     47000   0.52236098     0.20669624     0.72905722     0.027876531  
     48000   0.36703032     0.24431989     0.61135021     0.042659903  
     49000   0.28903714     0.19685836     0.4858955      0.037132932  
     50000   0.39293839     0.18886964     0.58180803     0.04189964   
     51000   0.62035992     0.13253224     0.75289216     0.051186428  
     52000   0.50401432     0.27260648     0.7766208      0.069505083  
     53000   0.78488498     0.11428094     0.89916592     0.043222568  
     54000   0.834862       0.19711322     1.0319752      0.05696557   
     55000   0.74763568     0.098680471    0.84631615     0.07182426   
     56000   0.59078171     0.16894715     0.75972886     0.075745608  
     57000   0.65544593     0.070379952    0.72582588     0.017488327  
     58000   0.830013       0.036655631    0.86666863     0.1225063    
     59000   0.8261732      0.090415198    0.9165884      0.089268055  
     60000   0.65345641     0.087792469    0.74124888     0.10071304   
     61000   0.63521729     0.040399149    0.67561644     0.10772139   
     62000   0.83620072     0.056412189    0.89261291     0.068925488  
     63000   1.0316043      0.06997542     1.1015797      0.083449494  
     64000   0.8158405      0.059553209    0.87539371     0.045446246  
     65000   0.70598041     0.057722542    0.76370295     0.06591553   
     66000   0.660723       0.057841989    0.71856499     0.067457946  
     67000   0.75129432     0.058586701    0.80988102     0.068917061  
     68000   0.89280478     0.058139583    0.95094436     0.063936375  
     69000   0.72215253     0.057434684    0.77958722     0.071340172  
     70000   0.56558829     0.059782461    0.62537075     0.066475961  
     71000   0.67107138     0.061975006    0.73304638     0.07351848   
     72000   0.77842018     0.063499436    0.84191962     0.069058074  
     73000   0.76614575     0.064440868    0.83058662     0.074243427  
     74000   0.69945137     0.065781137    0.76523251     0.068374588  
     75000   0.60990733     0.067778763    0.6776861      0.058286364  
     76000   0.58299035     0.069849053    0.6528394      0.079977984  
     77000   0.79613615     0.070868206    0.86700436     0.089778797  
     78000   0.8609066      0.069857919    0.93076452     0.061825498  
     79000   0.68395987     0.069571281    0.75353115     0.092373212  
     80000   0.61618465     0.072419969    0.68860462     0.071717901  
     81000   0.78059277     0.074193494    0.85478626     0.068349442  
     82000   1.0468893      0.072285572    1.1191749      0.063167628  
     83000   0.85521563     0.070509379    0.92572501     0.066982649  
     84000   0.71160059     0.07194188     0.78354247     0.09513445   
     85000   0.64039078     0.075308851    0.71569963     0.077850548  
     86000   0.73021578     0.077524049    0.80773982     0.11266896   
     87000   0.88822864     0.076493557    0.9647222      0.048368977  
     88000   0.74199859     0.074983049    0.81698164     0.10111745   
     89000   0.56082275     0.078441262    0.63926401     0.11024981   
     90000   0.64714956     0.082667635    0.72981719     0.064394564  
     91000   0.75928206     0.082005017    0.84128708     0.10670657   
     92000   0.78114191     0.081641996    0.8627839      0.088176061  
     93000   0.69531148     0.082656869    0.77796835     0.086879074  
     94000   0.52046216     0.086193367    0.60665552     0.095464026  
     95000   0.57537379     0.088437357    0.66381115     0.071290416  
     96000   0.82842794     0.082280976    0.91070892     0.2944977    
     97000   0.78809205     0.081908017    0.87000006    -0.06012703   
     98000   0.6619754      0.085783421    0.74775882    -0.16330958   
     99000   0.64323021     0.08016031     0.72339052     0.068101371  
    100000   0.91280623     0.076558194    0.98936443     0.25265356   
Loop time of 4.16585 on 8 procs for 100000 steps with 32 atoms

Performance: 2074005.560 tau/day, 24004.694 timesteps/s, 768.150 katom-step/s
99.8% CPU use with 8 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.49309    | 0.68091    | 0.78539    |  10.3 | 16.34
Neigh   | 0.0018813  | 0.0019323  | 0.0021762  |   0.2 |  0.05
Comm    | 1.4549     | 1.5571     | 1.6776     |   5.1 | 37.38
Output  | 0.0023197  | 0.0024863  | 0.0033732  |   0.7 |  0.06
Modify  | 1.5225     | 1.5796     | 1.6879     |   5.2 | 37.92
Other   |            | 0.3439     |            |       |  8.25

Nlocal:              4 ave           6 max           2 min
Histogram: 1 0 2 0 0 3 0 0 0 2
Nghost:         15.625 ave          18 max          13 min
Histogram: 1 0 0 0 3 0 2 0 1 1
Neighs:              8 ave          15 max           4 min
Histogram: 3 0 0 3 0 0 0 0 1 1

Total # of neighbors = 64
Ave neighs/atom = 2
Neighbor list builds = 1434
Dangerous builds = 0
Total wall time: 0:00:04
